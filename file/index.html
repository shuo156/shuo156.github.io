
<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="format-detection" content="telephone=no">
    <title>é«˜è€ƒæˆç»©æ¨¡æ‹Ÿç³»ç»Ÿ - ç§‹ç§‹åŒå­¦</title>
    <link rel="icon" href="data:,">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <link
        href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;800&family=Noto+Sans+SC:wght@300;400;700;900&display=swap"
        rel="stylesheet">
    <style>
        :root {
            --primary: #1e3a8a;
            --primary-light: #3b82f6;
            --accent: #f59e0b;
            --bg-gradient: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
            --card-bg: rgba(255, 255, 255, 0.8);
            --glass-border: rgba(255, 255, 255, 0.3);
        }

        * {
            -webkit-tap-highlight-color: transparent;
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Outfit', 'Noto Sans SC', sans-serif;
            background: var(--bg-gradient);
            min-height: 100vh;
            color: #1e293b;
            padding-bottom: env(safe-area-inset-bottom);
            overflow-x: hidden;
        }

        /* Premium Background Decorations */
        .bg-glow {
            position: fixed;
            width: 300px;
            height: 300px;
            background: radial-gradient(circle, rgba(59, 130, 246, 0.2) 0%, transparent 70%);
            border-radius: 50%;
            z-index: -1;
            filter: blur(50px);
        }

        .glow-1 {
            top: -100px;
            right: -100px;
        }

        .glow-2 {
            bottom: -100px;
            left: -100px;
        }

        /* Glassmorphism Classes */
        .glass-card {
            background: var(--card-bg);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid var(--glass-border);
            border-radius: 24px;
            box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.07);
        }

        .gradient-text {
            background: linear-gradient(135deg, #1e3a8a 0%, #3b82f6 100%);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .header-gradient {
            background: linear-gradient(135deg, #1e3a8a 0%, #1e40af 100%);
            box-shadow: 0 10px 25px -5px rgba(30, 58, 138, 0.3);
        }

        /* Animations */
        @keyframes modalEnter {
            from {
                opacity: 0;
                transform: scale(0.9) translateY(20px);
            }

            to {
                opacity: 1;
                transform: scale(1) translateY(0);
            }
        }

        @keyframes overlayEnter {
            from {
                opacity: 0;
            }

            to {
                opacity: 1;
            }
        }

        .modal-animation {
            animation: modalEnter 0.4s cubic-bezier(0.16, 1, 0.3, 1) forwards;
        }

        .overlay-animation {
            animation: overlayEnter 0.3s ease-out forwards;
        }

        /* Custom Tags */
        .tag {
            display: inline-flex;
            align-items: center;
            padding: 2px 8px;
            border-radius: 6px;
            font-size: 0.65rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .tag-985 {
            background: #fee2e2;
            color: #991b1b;
        }

        .tag-211 {
            background: #dbeafe;
            color: #1e40af;
        }

        .tag-local {
            background: #fef3c7;
            color: #92400e;
        }

        /* Result Popup Overlay */
        #resultOverlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(15, 23, 42, 0.6);
            backdrop-filter: blur(4px);
            z-index: 50;
            display: none;
            overflow-y: auto;
            padding: 20px;
            -webkit-overflow-scrolling: touch;
        }

        .results-container {
            max-width: 500px;
            margin: 20px auto;
            position: relative;
        }

        /* Form Styling */
        input[type="number"]::-webkit-inner-spin-button,
        input[type="number"]::-webkit-outer-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }

        .input-focus-effect:focus-within {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px -10px rgba(59, 130, 246, 0.4);
        }

        .btn-premium {
            background: linear-gradient(135deg, #1e3a8a 0%, #2563eb 100%);
            position: relative;
            overflow: hidden;
            transition: all 0.3s ease;
        }

        .btn-premium::after {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, transparent, rgba(255, 255, 255, 0.1), transparent);
            transform: rotate(45deg);
            transition: 0.5s;
        }

        .btn-premium:hover::after {
            left: 100%;
        }

        .btn-premium:active {
            transform: scale(0.98);
        }

        .pb-safe {
            padding-bottom: calc(1rem + env(safe-area-inset-bottom));
        }

        /* Roast Mode Styles */
        .roast-bg {
            background: #0f172a;
            color: #f1f5f9;
        }

        .roast-glitch {
            text-shadow: 2px 0 #ff00c1, -2px 0 #00fff9;
            animation: glitch 2s infinite linear alternate-reverse;
        }

        @keyframes glitch {
            0% {
                text-shadow: 2px 0 #ff00c1, -2px 0 #00fff9;
            }

            50% {
                text-shadow: -2px 0 #ff00c1, 2px 0 #00fff9;
            }

            100% {
                text-shadow: 2px 0 #ff00c1, -2px 0 #00fff9;
            }
        }

        .roast-card {
            background: rgba(30, 41, 59, 0.7);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 20px;
        }

        .share-gradient-border {
            background: linear-gradient(135deg, #fb7185, #6366f1, #22d3ee);
            padding: 2px;
            border-radius: 24px;
        }

        .neon-text-glow {
            text-shadow: 0 0 10px rgba(244, 63, 114, 0.8);
        }

        .scanner-line {
            height: 2px;
            background: linear-gradient(90deg, transparent, #fb7185, transparent);
            width: 100%;
            position: absolute;
            animation: scan 3s linear infinite;
        }

        @keyframes scan {
            0% {
                top: 0%;
                opacity: 0;
            }

            50% {
                opacity: 1;
            }

            100% {
                top: 100%;
                opacity: 0;
            }
        }
    </style>
</head>

<body class="flex flex-col items-center py-6 px-4">
    <div class="bg-glow glow-1"></div>
    <div class="bg-glow glow-2"></div>

    <!-- Header Section -->
    <header class="w-full max-w-md mb-8 text-center">
        <div class="header-gradient text-white p-6 rounded-3xl relative overflow-hidden">
            <div class="absolute -right-8 -top-8 w-32 h-32 bg-white/10 rounded-full blur-2xl"></div>

            <!-- Official Seal (å°ç« å¼ºåŒ–ç‰ˆ) -->
            <div class="absolute -top-1 -right-1 -rotate-12 z-20 pointer-events-none drop-shadow-2xl">
                <div
                    class="border-[5px] border-double border-rose-500 rounded-full w-28 h-28 flex flex-col items-center justify-center p-1 bg-white/10 backdrop-blur-md scale-75 sm:scale-100 origin-top-right">
                    <div
                        class="border-2 border-rose-500 rounded-full w-full h-full flex flex-col items-center justify-center text-rose-500 font-black">
                        <span class="text-[9px] tracking-[0.2em] mb-1 opacity-80">QIUQIU</span>
                        <div class="h-[2px] w-16 bg-rose-500 mb-1"></div>
                        <div class="text-center py-0.5">
                            <p class="text-base leading-none">å·²æ›´æ–°</p>
                            <p class="text-[10px] mt-1 tracking-tight">25å¹´æ•°æ®åº“</p>
                        </div>
                        <div class="h-[2px] w-16 bg-rose-500 mt-1"></div>
                        <span class="text-[8px] tracking-widest mt-1 opacity-80">OFFICIAL</span>
                    </div>
                </div>
            </div>

            <div class="flex flex-col items-center">
                <div
                    class="bg-blue-400/20 px-3 py-1 rounded-full text-[10px] font-extrabold tracking-[0.2em] border border-white/20 mb-3 backdrop-blur-sm">
                    QIUQIU Â· ç§‹ç§‹åŒå­¦
                </div>
                <h1 class="text-2xl font-black tracking-tight mb-1 whitespace-nowrap">å®‰å¾½çœæ–°é«˜è€ƒä½æ¬¡æ¨¡æ‹Ÿç³»ç»Ÿ</h1>
                <div class="text-blue-100 text-base font-black tracking-widest mb-2 opacity-90">é«˜è€ƒæˆç»©æ¨¡æ‹Ÿç³»ç»Ÿ</div>
                <p class="text-blue-200 text-xs font-light opacity-90">åŸºäº2025å¹´å®‰å¾½çœåƒä¸‡çº§æ¨¡å‹ç²¾å‡†é¢„æµ‹</p>
                <p class="text-blue-300/60 text-[10px] mt-2 font-medium tracking-widest">â€”â€” è¯¥æ•°æ®ä»…ä¾›å‚è€ƒ â€”â€”</p>
            </div>
        </div>
    </header>

    <!-- Main Entry Form -->
    <main class="w-full max-w-md glass-card p-6 mb-8 input-focus-effect transition-all duration-300">
        <form id="predictForm" class="space-y-6">
            <!-- Subject Selection -->
            <div>
                <label
                    class="block text-slate-500 text-[10px] font-black uppercase tracking-widest mb-3 px-1">é¦–é€‰ç§‘ç›®ç±»åˆ«</label>
                <div class="grid grid-cols-2 gap-4">
                    <label class="relative cursor-pointer group">
                        <input type="radio" name="subject" value="physics" class="peer sr-only" checked>
                        <div
                            class="flex items-center justify-center py-3 px-4 rounded-2xl border-2 border-slate-100 bg-slate-50 peer-checked:bg-white peer-checked:border-blue-600 peer-checked:text-blue-700 transition-all shadow-sm group-active:scale-95">
                            <span class="font-bold text-sm">ç‰©ç†ç±»</span>
                            <div
                                class="absolute -top-1.5 -right-1.5 w-5 h-5 bg-blue-600 text-white rounded-full flex items-center justify-center opacity-0 peer-checked:opacity-100 transition-opacity">
                                <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="3"
                                        d="M5 13l4 4L19 7"></path>
                                </svg>
                            </div>
                        </div>
                    </label>
                    <label class="relative cursor-pointer group">
                        <input type="radio" name="subject" value="history" class="peer sr-only">
                        <div
                            class="flex items-center justify-center py-3 px-4 rounded-2xl border-2 border-slate-100 bg-slate-50 peer-checked:bg-white peer-checked:border-blue-600 peer-checked:text-blue-700 transition-all shadow-sm group-active:scale-95">
                            <span class="font-bold text-sm">å†å²ç±»</span>
                            <div
                                class="absolute -top-1.5 -right-1.5 w-5 h-5 bg-blue-600 text-white rounded-full flex items-center justify-center opacity-0 peer-checked:opacity-100 transition-opacity">
                                <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="3"
                                        d="M5 13l4 4L19 7"></path>
                                </svg>
                            </div>
                        </div>
                    </label>
                </div>
            </div>

            <div>
    <label class="block text-slate-500 text-[10px] font-black uppercase tracking-widest mb-3 px-1">æ‰€åœ¨å¸‚(å·)</label>
    <select id="city" required class="sr-only">
        <option value="hefei" selected>åˆè‚¥å¸‚</option>
        <option value="fuyang">é˜œé˜³å¸‚</option>
        <option value="anqing">å®‰åº†å¸‚</option>
        <option value="lvan">å…­å®‰å¸‚</option>
        <option value="bozhou">äº³å·å¸‚</option>
        <option value="suzhou">å®¿å·å¸‚</option>
        <option value="chuzhou">æ»å·å¸‚</option>
        <option value="bengbu">èšŒåŸ å¸‚</option>
        <option value="tongling">é“œé™µå¸‚</option>
        <option value="xuancheng">å®£åŸå¸‚</option>
        <option value="maanshan">é©¬éå±±å¸‚</option>
        <option value="huainan">æ·®å—å¸‚</option>
        <option value="chizhou">æ± å·å¸‚</option>
        <option value="huangshan">é»„å±±å¸‚</option>
        <option value="huaibei">æ·®åŒ—å¸‚</option>
    </select>
</div>

                <div class="relative">
    <button type="button" id="cityBtn"
        class="w-full px-4 py-4 rounded-2xl border-2 border-slate-100 bg-slate-50 hover:bg-white focus:bg-white focus:border-blue-600 focus:ring-4 focus:ring-blue-100 font-extrabold text-slate-800 text-xl text-center transition-all outline-none flex items-center justify-center">
        <span id="cityBtnText">åˆè‚¥å¸‚</span>
        <span class="absolute right-4 top-1/2 -translate-y-1/2 text-slate-400 pointer-events-none">
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                    d="M19 9l-7 7-7-7">
                </path>
            </svg>
        </span>
    </button>
    <button type="button" onclick="openEduModal()"
        class="w-full mt-2 text-[10px] font-black tracking-widest text-blue-600 hover:text-blue-700 active:scale-95 transition-all text-center">
        æŸ¥çœ‹å„å¸‚ç»¼åˆæ’åä¸ä¿®æ­£ä¾æ®
    </button>

    <div id="cityMenu"
        class="hidden absolute left-0 right-0 mt-2 bg-white rounded-2xl border-2 border-slate-100 shadow-2xl overflow-hidden z-50">
        <div class="max-h-72 overflow-y-auto py-1">
            <button type="button" data-city="hefei"
                class="cityOption w-full px-4 py-3 text-slate-800 font-extrabold text-base text-center hover:bg-slate-50 transition-colors">
                åˆè‚¥å¸‚
            </button>
            <button type="button" data-city="fuyang"
                class="cityOption w-full px-4 py-3 text-slate-800 font-extrabold text-base text-center hover:bg-slate-50 transition-colors">
                é˜œé˜³å¸‚
            </button>
            <button type="button" data-city="anqing"
                class="cityOption w-full px-4 py-3 text-slate-800 font-extrabold text-base text-center hover:bg-slate-50 transition-colors">
                å®‰åº†å¸‚
            </button>
            <button type="button" data-city="lvan"
                class="cityOption w-full px-4 py-3 text-slate-800 font-extrabold text-base text-center hover:bg-slate-50 transition-colors">
                å…­å®‰å¸‚
            </button>
            <button type="button" data-city="bozhou"
                class="cityOption w-full px-4 py-3 text-slate-800 font-extrabold text-base text-center hover:bg-slate-50 transition-colors">
                äº³å·å¸‚
            </button>
            <button type="button" data-city="suzhou"
                class="cityOption w-full px-4 py-3 text-slate-800 font-extrabold text-base text-center hover:bg-slate-50 transition-colors">
                å®¿å·å¸‚
            </button>
            <button type="button" data-city="chuzhou"
                class="cityOption w-full px-4 py-3 text-slate-800 font-extrabold text-base text-center hover:bg-slate-50 transition-colors">
                æ»å·å¸‚
            </button>
            <button type="button" data-city="bengbu"
                class="cityOption w-full px-4 py-3 text-slate-800 font-extrabold text-base text-center hover:bg-slate-50 transition-colors">
                èšŒåŸ å¸‚
            </button>
            <button type="button" data-city="tongling"
                class="cityOption w-full px-4 py-3 text-slate-800 font-extrabold text-base text-center hover:bg-slate-50 transition-colors">
                é“œé™µå¸‚
            </button>
            <button type="button" data-city="xuancheng"
                class="cityOption w-full px-4 py-3 text-slate-800 font-extrabold text-base text-center hover:bg-slate-50 transition-colors">
                å®£åŸå¸‚
            </button>
            <button type="button" data-city="maanshan"
                class="cityOption w-full px-4 py-3 text-slate-800 font-extrabold text-base text-center hover:bg-slate-50 transition-colors">
                é©¬éå±±å¸‚
            </button>
            <button type="button" data-city="huainan"
                class="cityOption w-full px-4 py-3 text-slate-800 font-extrabold text-base text-center hover:bg-slate-50 transition-colors">
                æ·®å—å¸‚
            </button>
            <button type="button" data-city="chizhou"
                class="cityOption w-full px-4 py-3 text-slate-800 font-extrabold text-base text-center hover:bg-slate-50 transition-colors">
                æ± å·å¸‚
            </button>
            <button type="button" data-city="huangshan"
                class="cityOption w-full px-4 py-3 text-slate-800 font-extrabold text-base text-center hover:bg-slate-50 transition-colors">
                é»„å±±å¸‚
            </button>
            <button type="button" data-city="huaibei"
                class="cityOption w-full px-4 py-3 text-slate-800 font-extrabold text-base text-center hover:bg-slate-50 transition-colors">
                æ·®åŒ—å¸‚
            </button>
        </div>
    </div>
</div>


            <!-- Rank Input -->
            <div class="grid grid-cols-2 gap-4">
                <div>
                    <label
                        class="block text-slate-500 text-[10px] font-black uppercase tracking-widest mb-3 px-1">æ¨¡æ‹Ÿè€ƒè¯•å¸‚æ’å</label>
                    <div class="relative group">
                        <input type="number" id="rank" inputmode="numeric" pattern="[0-9]*" placeholder="0" required
                            min="1" max="50000"
                            class="w-full px-4 py-4 rounded-2xl border-2 border-slate-100 bg-slate-50 focus:bg-white focus:border-blue-600 focus:ring-4 focus:ring-blue-100 font-extrabold text-slate-800 text-xl text-center transition-all outline-none">
                        <div class="absolute right-3 top-1/2 -translate-y-1/2 text-slate-400 font-bold text-[10px]">å
                        </div>
                    </div>
                </div>
                <div>
                    <label
                        class="block text-slate-500 text-[10px] font-black uppercase tracking-widest mb-3 px-1">æ¨¡æ‹Ÿè€ƒè¯•æˆç»©</label>
                    <div class="relative group">
                        <input type="number" id="score" inputmode="numeric" pattern="[0-9]*" placeholder="0" required
                            min="0" max="750"
                            class="w-full px-4 py-4 rounded-2xl border-2 border-slate-100 bg-slate-50 focus:bg-white focus:border-blue-600 focus:ring-4 focus:ring-blue-100 font-extrabold text-slate-800 text-xl text-center transition-all outline-none">
                        <div class="absolute right-3 top-1/2 -translate-y-1/2 text-slate-400 font-bold text-[10px]">åˆ†
                        </div>
                    </div>
                </div>
            </div>
            <p class="text-[10px] text-slate-400 mt-2 ml-1">æ•°æ®è¶ŠçœŸå®ï¼Œåˆ†æè¶Šç²¾å‡†</p>

            <!-- Difficulty Evaluation -->
            <div>
                <label
                    class="block text-slate-500 text-[10px] font-black uppercase tracking-widest mb-3 px-1">ä¸ªäººéš¾åº¦ä½“æ„Ÿ</label>
                <div class="grid grid-cols-3 gap-2">
                    <label class="cursor-pointer group">
                        <input type="radio" name="difficulty" value="easy" class="peer sr-only">
                        <div
                            class="text-center py-3 rounded-xl border-2 border-slate-50 bg-slate-100 text-slate-400 peer-checked:bg-emerald-50 peer-checked:border-emerald-500 peer-checked:text-emerald-700 transition-all font-bold text-xs">
                            åæ˜“</div>
                    </label>
                    <label class="cursor-pointer group">
                        <input type="radio" name="difficulty" value="normal" class="peer sr-only" checked>
                        <div
                            class="text-center py-3 rounded-xl border-2 border-slate-50 bg-slate-100 text-slate-400 peer-checked:bg-blue-50 peer-checked:border-blue-500 peer-checked:text-blue-700 transition-all font-bold text-xs">
                            é€‚ä¸­</div>
                    </label>
                    <label class="cursor-pointer group">
                        <input type="radio" name="difficulty" value="hard" class="peer sr-only">
                        <div
                            class="text-center py-3 rounded-xl border-2 border-slate-50 bg-slate-100 text-slate-400 peer-checked:bg-rose-50 peer-checked:border-rose-500 peer-checked:text-rose-700 transition-all font-bold text-xs">
                            åéš¾</div>
                    </label>
                </div>
            </div>

            <button type="submit" id="submitBtn"
                class="w-full btn-premium text-white font-black py-5 rounded-2xl shadow-xl shadow-blue-200 transform hover:-translate-y-1 active:scale-95 transition-all text-lg tracking-widest flex items-center justify-center">
                <span id="btnText">ç«‹å³ç”Ÿæˆå¤šç»´åˆ†ææŠ¥è¡¨</span>
                <div id="loadingDots" class="hidden flex space-x-1 ml-2">
                    <div class="w-1.5 h-1.5 bg-white rounded-full animate-bounce"></div>
                    <div class="w-1.5 h-1.5 bg-white rounded-full animate-bounce" style="animation-delay: 0.2s"></div>
                    <div class="w-1.5 h-1.5 bg-white rounded-full animate-bounce" style="animation-delay: 0.4s"></div>
                </div>
            </button>
            <div class="mt-8 pt-2">
                <button type="button" onclick="openRoastModal()"
                    class="group w-full flex items-center justify-between p-4 rounded-2xl bg-slate-50/50 border border-dashed border-slate-200 hover:bg-rose-50 hover:border-rose-200 hover:border-solid transition-all duration-300">
                    <div class="flex items-center space-x-3">
                        <div
                            class="w-10 h-10 rounded-xl bg-slate-100 group-hover:bg-rose-500 flex items-center justify-center transition-all duration-300 overflow-hidden ring-4 ring-white">
                            <span class="text-xl group-hover:scale-125 transition-transform duration-300">ğŸ”¥</span>
                        </div>
                        <div class="text-left">
                            <p
                                class="text-[9px] font-black text-slate-400 group-hover:text-rose-600 transition-colors uppercase tracking-[0.2em] mb-0.5">
                                ä¸æƒ³çœ‹è¿™ç§æ­£ç»æŠ¥å‘Šï¼Ÿ</p>
                            <p class="text-xs font-extrabold text-slate-700">è¿›å…¥ã€ŒAI æ¯’èˆŒæµ‹è¯„ã€ç¦åŒº</p>
                        </div>
                    </div>
                    <div class="flex items-center space-x-2">
                        <span
                            class="text-[10px] font-black text-rose-500 opacity-0 group-hover:opacity-100 transition-opacity">GO!</span>
                        <svg class="w-5 h-5 text-slate-300 group-hover:text-rose-400 group-hover:translate-x-1 transition-all duration-300"
                            fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7">
                            </path>
                        </svg>
                    </div>
                </button>
                <p class="text-center text-[8px] text-slate-300 mt-3 font-medium tracking-widest uppercase opacity-50">
                    ANTI-CHICKEN SOUP ZONE Â· ç§‹ç§‹åŒå­¦ç‰¹åˆ«ç­–åˆ’</p>
            </div>
        </form>
    </main>

    <!-- Footer Branding -->
    <footer class="w-full max-w-md text-center opacity-60 px-4">
        <p class="text-[10px] font-bold text-slate-400 tracking-[0.3em]">TECHNICAL SUPPORT BY QIUQIU</p>
        <p class="text-[9px] text-slate-400 mt-1">ç§‹ç§‹åŒå­¦ Â· ä¸ºæ¢¦æƒ³ä¿é©¾æŠ¤èˆª</p>
    </footer>

    <!-- Result Popup Overlay -->
    <div id="resultOverlay" class="overlay-animation">
        <div class="results-container pb-safe">
            <!-- Modal Header -->
            <div class="flex justify-between items-center mb-4 px-2">
                <div class="flex items-center">
                    <div class="w-1 h-4 bg-blue-600 rounded-full mr-2"></div>
                    <span class="text-white font-black tracking-widest text-sm uppercase">Analysis Report</span>
                </div>
                <button onclick="closeOverlay()"
                    class="w-8 h-8 rounded-full bg-white/10 text-white flex items-center justify-center hover:bg-white/20 transition-all">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12">
                        </path>
                    </svg>
                </button>
            </div>

            <!-- Score Summary Card -->
            <div class="glass-card mb-6 p-6 modal-animation overflow-hidden relative">
                <div class="absolute -right-10 -top-10 w-40 h-40 bg-blue-600/5 rounded-full blur-3xl"></div>
                <div class="flex flex-col">
                    <div class="flex justify-between items-end mb-4">
                        <div>
                            <p class="text-[10px] font-bold text-slate-400 uppercase tracking-widest mb-1">é¢„ä¼°2025çœä½æ¬¡</p>
                            <h2 class="text-5xl font-black text-slate-800" id="estProvRank">---</h2>
                            <div class="mt-2 flex items-center justify-between gap-3">
                                <p class="text-[10px] font-bold text-slate-400 tracking-widest">
                                    å¸‚å·ï¼š<span class="text-slate-600" id="estCityName">---</span>
                                </p>
                                <div class="flex items-center gap-1 flex-nowrap">
                                    <button type="button" id="feedbackHighBtn"
                                        class="px-2 py-1 rounded-full bg-rose-50 text-rose-600 border border-rose-100 text-[10px] font-black tracking-widest active:scale-95 transition-transform whitespace-nowrap">
                                        åé«˜
                                    </button>
                                    <button type="button" id="feedbackLowBtn"
                                        class="px-2 py-1 rounded-full bg-emerald-50 text-emerald-700 border border-emerald-100 text-[10px] font-black tracking-widest active:scale-95 transition-transform whitespace-nowrap">
                                        åä½
                                    </button>
                                    <button type="button" id="feedbackOkBtn"
                                        class="px-2 py-1 rounded-full bg-blue-50 text-blue-700 border border-blue-100 text-[10px] font-black tracking-widest active:scale-95 transition-transform whitespace-nowrap">
                                        ä¸é”™
                                    </button>
                                    <button type="button" onclick="captureReport()"
                                        class="px-2 py-1 rounded-full bg-emerald-50 text-emerald-700 border border-emerald-100 text-[10px] font-black tracking-widest active:scale-95 transition-transform whitespace-nowrap">
                                        åˆ†äº«æµ·æŠ¥
                                    </button>
                                </div>
                            </div>
                            <div class="mt-2 text-[9px] text-slate-400 font-bold tracking-widest" id="feedbackHint">
                                åé¦ˆè¶Šå¤šï¼Œé¢„æµ‹è¶Šå‡†ï¼ˆä»…ç”¨äºæ•°æ®é‡‡é›†ï¼‰
                            </div>
                            <div class="mt-1 text-[9px] text-slate-400 font-bold tracking-widest" id="feedbackStatus"></div>
                            <div class="mt-2 text-[9px] text-slate-400 font-bold tracking-widest" id="shareActionStatus"></div>
                        </div>
                        <div class="text-right">
                            <p class="text-[10px] font-bold text-slate-400 uppercase tracking-widest mb-1">å‚è€ƒé«˜è€ƒåˆ†</p>
                            <p class="text-3xl font-black text-blue-600"><span class="text-lg">â‰ˆ</span><span
                                    id="estScore">---</span><span class="text-xs ml-1 font-bold">PTS</span></p>
                        </div>
                    </div>

                    <!-- New: Mock Analysis Section -->
                    <div
                        class="bg-blue-600 rounded-2xl p-4 text-white mb-6 shadow-lg shadow-blue-200 relative overflow-hidden">
                        <div class="absolute right-0 top-0 opacity-10 transform translate-x-4 -translate-y-4">
                            <svg class="w-24 h-24" fill="currentColor" viewBox="0 0 24 24">
                                <path
                                    d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z" />
                            </svg>
                        </div>
                        <div class="relative z-10">
                            <p id="mockHeader" class="text-[10px] font-bold text-blue-100 uppercase tracking-widest mb-1">2026æ¨¡æ‹Ÿè€ƒè¯•Â·å®˜æ–¹å¯¹æ ‡æ°´å¹³</p>
                            <div class="mt-1 space-y-1">
                                <div class="text-2xl font-black leading-tight" id="mockLevelName">---</div>
                                <div class="text-[10px] font-medium opacity-90 leading-snug" id="mockLevelAdvise">æ­£åœ¨åˆ†æå¤ä¹ å»ºè®®...</div>
                            </div>
                        </div>
                    </div>

                    <div class="grid grid-cols-3 gap-3">
                        <div class="bg-rose-50/50 p-2 rounded-xl text-center border border-rose-100">
                            <p class="text-[8px] text-rose-400 font-bold mb-0.5">å½•å–æ³¢åŠ¨</p>
                            <p class="text-xs font-black text-rose-700">Â±1.2%</p>
                        </div>
                        <div class="bg-sky-50/50 p-2 rounded-xl text-center border border-sky-100">
                            <p class="text-[8px] text-sky-400 font-bold mb-0.5">ç½®ä¿¡åŒºé—´</p>
                            <p class="text-xs font-black text-sky-700">98.5%</p>
                        </div>
                        <div class="bg-emerald-50/50 p-2 rounded-xl text-center border border-emerald-100">
                            <p class="text-[8px] text-emerald-400 font-bold mb-0.5">è®¡ç®—è€—æ—¶</p>
                            <p class="text-xs font-black text-emerald-700" id="calcCost">--ms</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Recommendations -->
            <div class="space-y-6 modal-animation" style="animation-delay: 0.1s;">
                <!-- Chong Section -->
                <div class="glass-card overflow-hidden">
                    <div class="bg-rose-50/80 px-4 py-3 border-b border-rose-100 flex justify-between items-center">
                        <div class="flex items-center">
                            <div class="w-1.5 h-1.5 rounded-full bg-rose-500 mr-2 shadow-[0_0_8px_rgba(244,63,94,0.6)]">
                            </div>
                            <span class="text-rose-900 font-black text-xs tracking-wider">å†²åˆºé™¢æ ¡ Â· HIGHER RISK</span>
                        </div>
                        <span class="text-[8px] font-bold text-rose-400 uppercase">Top Reach</span>
                    </div>
                    <div class="p-2 space-y-1" id="listChong"></div>
                </div>

                <!-- Wen Section -->
                <div class="glass-card overflow-hidden border-blue-200 border-2 relative">
                    <div
                        class="absolute -right-2 top-2 bg-blue-600 text-white text-[8px] px-2 py-0.5 rounded-l-md font-bold uppercase tracking-widest z-10 shadow-lg">
                        Preferred</div>
                    <div class="bg-blue-50/80 px-4 py-3 border-b border-blue-100 flex justify-between items-center">
                        <div class="flex items-center">
                            <div class="w-1.5 h-1.5 rounded-full bg-blue-600 mr-2 shadow-[0_0_8px_rgba(37,99,235,0.6)]">
                            </div>
                            <span class="text-blue-900 font-black text-xs tracking-wider">ç¨³å¦¥é™¢æ ¡ Â· TARGET MATCH</span>
                        </div>
                        <span class="text-[8px] font-bold text-blue-400 uppercase">Highest Match</span>
                    </div>
                    <div class="p-2 space-y-1" id="listWen"></div>
                </div>

                <!-- Bao Section -->
                <div class="glass-card overflow-hidden">
                    <div
                        class="bg-emerald-50/80 px-4 py-3 border-b border-emerald-100 flex justify-between items-center">
                        <div class="flex items-center">
                            <div
                                class="w-1.5 h-1.5 rounded-full bg-emerald-500 mr-2 shadow-[0_0_8px_rgba(16,185,129,0.6)]">
                            </div>
                            <span class="text-emerald-900 font-black text-xs tracking-wider">ä¿åº•é™¢æ ¡ Â· SAFETY ZONE</span>
                        </div>
                        <span class="text-[8px] font-bold text-emerald-400 uppercase">Secure</span>
                    </div>
                    <div class="p-2 space-y-1" id="listBao"></div>
                </div>
            </div>

            <!-- Disclaimer & CTA -->
            <div class="mt-8 mb-4 modal-animation" style="animation-delay: 0.2s;">
                <div
                    class="glass-card p-5 bg-gradient-to-br from-slate-800 to-slate-900 text-white border-none shadow-2xl relative overflow-hidden">
                    <div class="absolute -right-4 -top-4 w-24 h-24 bg-blue-500/10 rounded-full blur-2xl"></div>

                    <h4 class="text-xs font-black tracking-widest mb-3 flex items-center text-blue-400">
                        <svg class="w-3 h-3 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="3"
                                d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253">
                            </path>
                        </svg>
                        A MESSAGE FROM PHYSICS TEACHER Â· ç‰©ç†è€å¸ˆæœ‰è¯è¯´
                    </h4>

                    <div class="text-[10px] text-slate-300 space-y-3 leading-relaxed font-light mb-6">
                        <div class="flex items-start">
                            <span class="w-1.5 h-1.5 rounded-full bg-blue-500 mt-1 mr-2 flex-shrink-0"></span>
                            <p>æ— è®ºä½ è¿™æ¬¡è€ƒå¾—å¥½è¿˜æ˜¯ä¸ç†æƒ³ï¼ŒçœŸæ­£æ‹‰å¼€å·®è·çš„ä»æ¥ä¸æ˜¯â€œåˆ†æ•°æœ¬èº«â€ï¼Œè€Œæ˜¯ä½ å¯¹è¿™å¼ å·å­çš„å¤ç›˜æ·±åº¦ã€‚</p>
                        </div>
                        <div class="flex items-start">
                            <span class="w-1.5 h-1.5 rounded-full bg-blue-500 mt-1 mr-2 flex-shrink-0"></span>
                            <p>è¯•å·åˆ†æåšå¯¹äº†ï¼Œä½ æ‰èƒ½çŸ¥é“ï¼šä¸¢åˆ†ç‚¹åœ¨å“ªã€èƒ½è¡¥å›å¤šå°‘ã€ä¸‹ä¸€é˜¶æ®µè¯¥æ€ä¹ˆç»ƒï¼Œè¿›æ­¥æ‰ä¼šå˜å¾—å¯æ§ã€‚</p>
                        </div>
                        <div class="flex items-start">
                            <span class="w-1.5 h-1.5 rounded-full bg-blue-500 mt-1 mr-2 flex-shrink-0"></span>
                            <p>ä¸‹é¢æä¾›ä¸€ä»½å…¨çœé€šç”¨çš„ã€è¯•å·åˆ†ææŠ¥å‘Šæ¨¡æ¿ã€‘å‚è€ƒï¼Œä½ å¯ä»¥ç…§ç€æŠŠâ€œä¼šçš„é¢˜ä¸¢çš„åˆ†â€ä¸€é¡¹é¡¹æ‰¾å›æ¥ã€‚</p>
                        </div>
                    </div>

                    <!-- Template Link Button -->
                    <button onclick="openTemplate()"
                        class="w-full py-3 mb-6 rounded-xl bg-white/5 border border-white/10 flex items-center justify-center hover:bg-white/10 transition-all group">
                        <span
                            class="text-[10px] font-bold tracking-widest text-slate-300 group-hover:text-white">æŸ¥çœ‹ï¼šè¯•å·åˆ†ææŠ¥å‘Šæ¨¡æ¿</span>
                        <svg class="w-3 h-3 ml-2 text-blue-400 group-hover:translate-x-1 transition-transform"
                            fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M14 5l7 7m0 0l-7 7m7-7H3"></path>
                        </svg>
                    </button>

                    <div class="p-4 rounded-2xl bg-blue-600/10 border border-blue-500/20 backdrop-blur-md">
                        <div class="flex items-center justify-between mb-3">
                            <div>
                                <p class="text-[10px] font-bold text-blue-400">PRACTICAL ADVICES</p>
                                <p class="text-xs font-black">é¢„çº¦ç‰©ç† 1:1 å·é¢é”™é¢˜å¤ç›˜</p>
                            </div>
                            <div
                                class="w-8 h-8 rounded-full bg-blue-600 flex items-center justify-center animate-pulse shadow-[0_0_15px_rgba(37,99,235,0.4)]">
                                <svg class="w-4 h-4 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="3"
                                        d="M12 4v16m8-8H4"></path>
                                </svg>
                            </div>
                        </div>
                        <p class="text-[10px] text-white/60 mb-4 leading-tight">
                            æ·»åŠ å¾®ä¿¡å¹¶å‘é€ã€æ¨¡æ‹Ÿè€ƒè¯•è§£æã€‘ï¼Œæˆ‘ä»¬å¯ä»¥èŠèŠé‚£äº›æ‰£åˆ†ç‚¹åˆ°åº•å‡ºåœ¨å“ªã€‚æˆ‘ä¼šå¸®ä½ åˆ¶å®šåç»­çš„å¤ä¹ èŠ‚å¥ã€‚
                            <br><span class="text-amber-400 font-bold">ã€ç§‹ç§‹åŒå­¦ã€‘æ¯æ—¥åé¢æœ‰é™ï¼Œæ—¨åœ¨é™ªå­©å­å®å®åœ¨åœ¨è·¨è¿‡è¿™ä¸€å…³ã€‚</span>
                        </p>
                        <button onclick="copyWechat()"
                            class="w-full py-3 px-4 rounded-xl bg-blue-600 hover:bg-blue-500 active:scale-95 transition-all flex items-center justify-center shadow-lg shadow-blue-900/40">
                            <span class="text-xs font-black tracking-widest" id="wechatText">æ·»åŠ å¾®ä¿¡ï¼šé¢„çº¦æ·±åº¦å¤ç›˜</span>
                        </button>
                    </div>
                </div>
            </div>

            <div class="mt-4 px-4 py-3 bg-slate-900/30 rounded-xl border border-white/5">
                <p class="text-[8px] text-slate-400 leading-relaxed text-justify">
                    <span
                        class="font-bold text-slate-300">å…è´£å£°æ˜ï¼š</span>æœ¬ç³»ç»Ÿæ‰€ç”Ÿæˆçš„é¢„ä¼°åˆ†æ•°ã€ä½æ¬¡åŠæ¨èé™¢æ ¡ä»…åŸºäºâ€œæœ¬å¸‚æ’å-å®‰å¾½çœä½æ¬¡â€è½¬æ¢æ¨¡å‹åŠ2025å¹´å½•å–æ•°æ®è¿›è¡Œæ•°å­¦æ¨¡æ‹Ÿï¼Œä¸ä»£è¡¨å®˜æ–¹æœ€ç»ˆç»“è®ºã€‚ä»»ä½•å…³äºå¿—æ„¿å¡«æŠ¥çš„å†³ç­–åº”ä»¥å®‰å¾½çœæ•™è‚²è€ƒè¯•é™¢å…¬å¸ƒçš„æ­£å¼æ•°æ®ä¸ºå‡†ã€‚å¼€å‘è€…ï¼ˆç§‹ç§‹åŒå­¦ï¼‰ä¸å¯¹å› å‚è€ƒæœ¬ç³»ç»Ÿè€Œäº§ç”Ÿçš„ä»»ä½•å†³ç­–åæœæ‰¿æ‹…æ³•å¾‹è´£ä»»ã€‚
                </p>
            </div>

            <button onclick="closeOverlay()"
                class="w-full py-4 text-slate-400 text-[10px] font-bold tracking-[0.3em] uppercase hover:text-white transition-colors">
                Return to Simulation Â· è¿”å›
            </button>
        </div>
    </div>

    <div
        style="position: absolute; top: 0; left: 0; width: 0; height: 0; overflow: hidden; pointer-events: none;">
        <div id="shareReportCard" class="bg-[#020617] p-0 overflow-hidden font-['Outfit']"
            style="width: 420px; visibility: hidden;">
            <div class="h-2 w-full bg-gradient-to-r from-blue-500 via-indigo-500 to-emerald-400"></div>
            <div class="p-10">
                <div class="flex items-start justify-between mb-10">
                    <div>
                        <div class="text-[9px] text-slate-400 font-bold tracking-[0.35em] uppercase">QIUQIU Â· SIMULATION REPORT</div>
                        <div class="mt-3 text-[34px] leading-[1] font-black text-white" id="shareReportRank">---</div>
                        <div class="mt-2 text-[10px] text-slate-400 font-bold tracking-widest">
                            <span id="shareReportSubject">---</span> Â· <span id="shareReportCity">---</span> Â· å‚è€ƒåˆ†â‰ˆ<span id="shareReportScore">---</span>
                        </div>
                    </div>
                    <div class="text-right">
                        <div class="text-[10px] text-slate-500 font-bold tracking-widest">é¢„ä¼°çœä½æ¬¡</div>
                        <div class="text-[44px] font-black text-blue-400/20 leading-none">JL</div>
                    </div>
                </div>

                <div class="share-gradient-border mb-10 shadow-2xl">
                    <div class="bg-[#0f172a] rounded-[22px] p-7 space-y-6">
                        <div>
                            <div class="flex items-center justify-between mb-2">
                                <div class="text-[10px] font-black text-rose-400 tracking-widest">å†²åˆº</div>
                                <div class="text-[9px] font-bold text-slate-500" id="shareReportChongRange">---</div>
                            </div>
                            <div class="text-[11px] font-bold text-slate-200 leading-relaxed" id="shareReportChongTop">---</div>
                        </div>
                        <div class="border-t border-white/5 pt-6">
                            <div class="flex items-center justify-between mb-2">
                                <div class="text-[10px] font-black text-blue-400 tracking-widest">ç¨³å¦¥</div>
                                <div class="text-[9px] font-bold text-slate-500" id="shareReportWenRange">---</div>
                            </div>
                            <div class="text-[11px] font-bold text-slate-200 leading-relaxed" id="shareReportWenTop">---</div>
                        </div>
                        <div class="border-t border-white/5 pt-6">
                            <div class="flex items-center justify-between mb-2">
                                <div class="text-[10px] font-black text-emerald-400 tracking-widest">ä¿åº•</div>
                                <div class="text-[9px] font-bold text-slate-500" id="shareReportBaoRange">---</div>
                            </div>
                            <div class="text-[11px] font-bold text-slate-200 leading-relaxed" id="shareReportBaoTop">---</div>
                        </div>
                    </div>
                </div>

                <div class="flex items-end justify-between">
                    <div class="flex-1 pr-6 pb-1">
                        <div class="text-xs font-black text-white mb-2">ç§‹ç§‹åŒå­¦ Â· é«˜è€ƒæ¨¡æ‹Ÿç³»ç»Ÿ</div>
                        <div class="text-[10px] text-slate-500 leading-relaxed font-bold">
                            é•¿æŒ‰è¯†åˆ«äºŒç»´ç  â†’<br>
                            <span class="text-slate-300">ç”Ÿæˆä½ çš„ä¸“å±æ¨¡æ‹Ÿè€ƒè¯•åˆ†ææŠ¥è¡¨</span>
                        </div>
                    </div>
                    <div class="relative">
                        <div
                            class="absolute -inset-2 bg-gradient-to-tr from-blue-500 to-emerald-400 rounded-2xl blur-md opacity-30">
                        </div>
                        <div class="relative w-24 h-24 bg-white p-2 rounded-2xl shadow-2xl">
                            <img id="reportQrCode" src="qrcode_official.png" alt="QR" crossorigin="anonymous" class="w-full h-full">
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Physics Template Modal -->
    <div id="templateOverlay"
        class="fixed inset-0 bg-white z-[100] hidden overflow-y-auto p-0 flex-col animate-overlayEnter">
        <!-- Sticky Header -->
        <div
            class="sticky top-0 bg-white/80 backdrop-blur-md border-b border-slate-100 px-6 py-4 flex justify-between items-center z-20">
            <div class="flex items-center space-x-3">
                <div class="bg-blue-600 text-white p-2 rounded-xl font-black text-xs">ç§‹ç§‹</div>
                <div>
                    <h3 class="text-xs font-black text-slate-900">2026 è¯•å·åˆ†ææŠ¥å‘Šæ¨¡æ¿ï¼ˆå…¨çœé€šç”¨ï¼‰</h3>
                    <p class="text-[8px] text-slate-400 uppercase tracking-widest font-bold">Produced by Qiuqiu
                        Academic Dept.</p>
                </div>
            </div>
            <button onclick="closeTemplate()"
                class="bg-slate-100 hover:bg-slate-200 text-slate-600 px-4 py-2 rounded-full font-bold text-[10px] transition-all">
                å…³é—­é¢„è§ˆ / Return
            </button>
        </div>

        <div class="max-w-2xl mx-auto py-10 px-6 pb-24 space-y-12">
            <!-- Part 0: Report Branding -->
            <div class="text-center space-y-2 border-b-2 border-slate-900 pb-10">
                <div class="text-blue-600 font-black text-[10px] tracking-[0.4em] uppercase mb-4">Qiuqiu Scientific
                    Analysis System</div>
                <h1 class="text-3xl font-black text-slate-900 leading-tight">2026å®‰å¾½çœæ¨¡æ‹Ÿè€ƒè¯•Â·è¯•å·åˆ†ææŠ¥å‘Šæ¨¡æ¿<br>& ä¸‰é˜¶æ®µå¤ä¹ æåˆ†è·¯å¾„å›¾</h1>
                <div class="flex justify-center flex-wrap gap-3 mt-6">
                    <span
                        class="bg-slate-50 border border-slate-200 px-3 py-1.5 rounded-lg text-[9px] font-bold text-slate-500">è€å¸ˆï¼šç§‹ç§‹åŒå­¦ç‰©ç†ç»„</span>
                    <span
                        class="bg-slate-50 border border-slate-200 px-3 py-1.5 rounded-lg text-[9px] font-bold text-slate-500">å»ºè®®ç‰ˆæœ¬ï¼šå®ç”¨è¯Šæ–­ç‰ˆ</span>
                </div>
            </div>

            <!-- Part 1: Radar View -->
            <div class="space-y-4">
                <div class="flex items-center space-x-2">
                    <div class="w-1.5 h-4 bg-blue-600 rounded-full"></div>
                    <h2 class="text-sm font-black text-slate-900 uppercase">Focus Area Â· ç‰©ç†èƒ½åŠ›é¡¹å¤ç›˜</h2>
                </div>
                <div class="bg-slate-50 rounded-3xl p-8 border border-slate-100 grid md:grid-cols-2 gap-8 items-center">
                    <div class="relative w-48 h-48 mx-auto flex items-center justify-center">
                        <div class="absolute inset-0 border-2 border-slate-200 rounded-full border-dashed opacity-50">
                        </div>
                        <div class="absolute inset-4 border-2 border-slate-200 rounded-full border-dashed opacity-50">
                        </div>
                        <div class="absolute inset-8 border-2 border-slate-200 rounded-full border-dashed opacity-50">
                        </div>
                        <div class="w-full h-full flex items-center justify-center relative z-10">
                            <svg viewBox="0 0 100 100" class="w-full h-full text-blue-600/20 fill-blue-600/30">
                                <polygon points="50,10 85,35 75,75 50,90 25,75 15,35" stroke="currentColor"
                                    stroke-width="2" />
                            </svg>
                        </div>
                        <span
                            class="absolute -top-2 left-1/2 -translate-x-1/2 text-[8px] font-black text-slate-400">æ¨¡å‹æŠ½è±¡</span>
                        <span
                            class="absolute top-1/2 -right-6 -translate-y-1/2 text-[8px] font-black text-slate-400">æ•°å­¦è®¡ç®—</span>
                        <span
                            class="absolute -bottom-2 left-1/2 -translate-x-1/2 text-[8px] font-black text-slate-400">å®éªŒé€»è¾‘</span>
                        <span
                            class="absolute top-1/2 -left-6 -translate-y-1/2 text-[8px] font-black text-slate-400">æƒ…å¢ƒæ‹†è§£</span>
                    </div>
                    <div class="space-y-4">
                        <p class="text-[11px] leading-relaxed text-slate-500 text-justify italic">
                            æœ¬ç”Ÿåœ¨<span class="text-blue-600 font-bold">ã€æ¨¡å‹æŠ½è±¡ã€‘</span>ä¸<span
                                class="text-blue-600 font-bold">ã€æƒ…å¢ƒæ‹†è§£ã€‘</span>ç»´åº¦å­˜åœ¨é‡åº¦çŸ­æ¿ã€‚é¢å¯¹å…¨çœæ¨¡æ‹Ÿè€ƒè¯•å¸¸è§çš„å¤æ‚é¢˜ç›®èƒŒæ™¯ï¼Œæ— æ³•æœ‰æ•ˆå‰¥ç¦»å¹²æ‰°ä¿¡æ¯ï¼Œå¯¼è‡´é¢˜ç›®å…¥æ‰‹ç‚¹æ‰¾å¯»å›°éš¾ï¼Œç›´æ¥å¯¼è‡´è®¡ç®—é¢˜ç¬¬ä¸€é—®å¾—åˆ†ç‡ä¸è¶³
                            40%ã€‚
                        </p>
                        <div class="flex space-x-2">
                            <div class="flex-1 bg-white p-2 rounded-xl border border-slate-100 shadow-sm text-center">
                                <p class="text-[8px] font-bold text-slate-400 mb-0.5">è¯»é¢˜æ•ˆç‡</p>
                                <p class="text-xs font-black text-slate-800">åæ…¢</p>
                            </div>
                            <div class="flex-1 bg-white p-2 rounded-xl border border-slate-100 shadow-sm text-center">
                                <p class="text-[8px] font-bold text-slate-400 mb-0.5">å¤±è¯¯å€¾å‘</p>
                                <p class="text-xs font-black text-rose-500">æƒ¯æ€§é”™é€‰</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Part 2: Table Section -->
            <div class="space-y-4">
                <div class="flex items-center space-x-2">
                    <div class="w-1.5 h-4 bg-blue-600 rounded-full"></div>
                    <h2 class="text-sm font-black text-slate-900 uppercase">Item Fault Trace Â· å·é¢å¤±åˆ†æº¯æºç»†èŠ‚</h2>
                </div>
                <div class="overflow-hidden border border-slate-100 rounded-3xl">
                    <table class="w-full text-left border-collapse">
                        <thead>
                            <tr
                                class="bg-slate-900 text-white font-bold text-[9px] uppercase tracking-widest text-center">
                                <th class="px-4 py-4 border-r border-slate-800">é¢˜å·</th>
                                <th class="px-4 py-4 border-r border-slate-800 text-left">å¯¹æ ‡çŸ¥è¯†ç‚¹</th>
                                <th class="px-4 py-4 border-r border-slate-800">å¤±åˆ†æº¯æº (Root Cause)</th>
                                <th class="px-4 py-4">æ¨èåç»­ä»»åŠ¡</th>
                            </tr>
                        </thead>
                        <tbody class="divide-y divide-slate-100 text-[10px]">
                            <tr>
                                <td class="px-4 py-5 font-black text-center bg-slate-50/50">ç¬¬ 4 é¢˜</td>
                                <td class="px-4 py-5">
                                    <span class="font-bold text-slate-800">æ’å®šç”µæµ - æ•ˆç‡åˆ†æ</span>
                                    <div class="text-[8px] text-slate-400 mt-1">é—­åˆç”µè·¯æ¬§å§†å®šå¾‹å˜å¼</div>
                                </td>
                                <td class="px-4 py-5 text-rose-500 font-bold text-center leading-tight">
                                    æ¦‚å¿µä¸æ¸…ï¼šè¯¯å°†è¾“å‡ºåŠŸç‡å¢ç›Š<br>ç­‰åŒäºç”µæºæ•ˆç‡ã€‚</td>
                                <td class="px-4 py-5 text-slate-500 text-center">é‡è¯»æ•™æ P12 å®šä¹‰åŒº</td>
                            </tr>
                            <tr>
                                <td class="px-4 py-5 font-black text-center bg-slate-50/50">ç¬¬ 15 é¢˜</td>
                                <td class="px-4 py-5">
                                    <span class="font-bold text-slate-800">é€‰ä¿®éƒ¨åˆ† - çƒ­å­¦/å…‰å­¦</span>
                                    <div class="text-[8px] text-slate-400 mt-1">æ°”ä½“çŠ¶ä½“æ–¹ç¨‹/æŠ˜å°„ç‡</div>
                                </td>
                                <td class="px-4 py-5 text-rose-500 font-bold text-center leading-tight">
                                    è®¡ç®—å¤±è¯¯ï¼šå•ä½æ¢ç®—æ¼é¡¹<br>(cmHg â†’ Pa)</td>
                                <td class="px-4 py-5 text-slate-500 text-center">å•ä½æ ‡æ³¨æ³•é’ˆå¯¹è®­ç»ƒ</td>
                            </tr>
                            <tr class="bg-blue-50/20">
                                <td class="px-4 py-5 font-black text-center">ç¬¬ 21 é¢˜</td>
                                <td class="px-4 py-5">
                                    <span class="font-bold text-slate-800">å‹è½´é¢˜ - åŠ¨é‡å®ˆæ’/ç¢°æ’</span>
                                    <div class="text-[8px] text-slate-400 mt-1">å¤šè¿‡ç¨‹èƒ½é‡è½¬åŒ–åˆ†æ</div>
                                </td>
                                <td class="px-4 py-5 text-blue-600 font-bold text-center leading-tight">
                                    ã€äº®ç‚¹ã€‘èƒ½é‡ä¸´ç•Œç‚¹æŠ“å–æå‡†<br>ä½†åœ¨ä»£æ•°å¼ä¹¦å†™ä¸­é—æ¼ç¬¦å·</td>
                                <td class="px-4 py-5 text-slate-500 text-center">æé¢†ä¹¦å†™è§„èŒƒ 1:1 æŒ‡å¯¼</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Part 3: Step Plan -->
            <div class="space-y-8">
                <div class="flex items-center space-x-2">
                    <div class="w-1.5 h-4 bg-blue-600 rounded-full"></div>
                    <h2 class="text-sm font-black text-slate-900 uppercase">Qiuqiu Stairway Plan Â· ç§‹ç§‹åŒå­¦åç»­å¤ä¹ è·¯å¾„</h2>
                </div>

                <div
                    class="relative pl-6 space-y-12 before:content-[''] before:absolute before:left-[11px] before:top-2 before:bottom-2 before:w-0.5 before:bg-slate-100">
                    <div class="relative">
                        <div
                            class="absolute -left-8 top-0 w-4 h-4 rounded-full bg-blue-600 border-4 border-white z-10 shadow-sm">
                        </div>
                        <div class="bg-white p-6 rounded-3xl border border-slate-100 shadow-xl shadow-slate-200/50">
                            <h3 class="text-xs font-black text-slate-800 mb-4 flex items-center">
                                <span
                                    class="bg-blue-600 text-white w-5 h-5 flex items-center justify-center rounded-md mr-2 text-[10px]">01</span>
                                åŸºç¡€å¤¯å®ä¸å…¬å¼è„±äº§æœŸï¼ˆæ¨¡æ‹Ÿè€ƒè¯•å 3 å‘¨ï¼‰
                            </h3>
                            <div class="space-y-3 text-[10px] text-slate-500 leading-relaxed">
                                <p>â€¢ <span class="text-slate-900 font-bold">å—åŠ›åˆ†æåœ°æ¯¯æ‰«è¡ï¼š</span> é’ˆå¯¹å¸¸è§„åŠ›å­¦æ¨¡å‹è¿›è¡Œæ—¥å‡ 15
                                    é“æ¯é¢˜æ·±åº¦æ‹†è§£ï¼Œå¿…é¡»åšåˆ°å—åŠ›åˆ†æå›¾â€œé›¶ç‘•ç–µâ€ã€‚</p>
                                <p>â€¢ <span class="text-slate-900 font-bold">äºŒè½®è¡”æ¥ï¼š</span> é‡ç‚¹å›é¡¾ç§‹ç§‹è®²ä¹‰ã€ç”µå­¦åŸºç¡€ 24
                                    è®²ã€‘ï¼Œæ¸…ç©ºç”µåœºåŠ¿èƒ½ã€ç”µåŠ¿å·®è®¡ç®—çš„æ­»è§’ã€‚</p>
                            </div>
                        </div>
                    </div>

                    <div class="relative">
                        <div
                            class="absolute -left-8 top-0 w-4 h-4 rounded-full bg-slate-200 border-4 border-white z-10 shadow-sm">
                        </div>
                        <div class="bg-slate-50 p-6 rounded-3xl border border-slate-100 opacity-60">
                            <h3 class="text-xs font-black text-slate-400 mb-4 flex items-center">
                                <span
                                    class="bg-slate-200 text-white w-5 h-5 flex items-center justify-center rounded-md mr-2 text-[10px]">02</span>
                                ä¸“é¢˜æ”»åšä¸æ¨¡æ€è¿ç§»æœŸ (åç»­ 4-8 å‘¨)
                            </h3>
                            <p class="text-[10px] text-slate-400">é‡ç‚¹æ”»å…³ç”µç£ç»„åˆåœºã€ç£çº¦æŸã€èƒ½é‡å®ˆæ’å˜å¼ä¸“é¢˜ã€‚</p>
                        </div>
                    </div>

                    <div class="relative">
                        <div
                            class="absolute -left-8 top-0 w-4 h-4 rounded-full bg-slate-200 border-4 border-white z-10 shadow-sm">
                        </div>
                        <div class="bg-slate-50 p-6 rounded-3xl border border-slate-100 opacity-60">
                            <h3 class="text-xs font-black text-slate-400 mb-4 flex items-center">
                                <span
                                    class="bg-slate-200 text-white w-5 h-5 flex items-center justify-center rounded-md mr-2 text-[10px]">03</span>
                                ç­”é¢˜è§„èŒƒä¸é™æ—¶å›å½’æœŸ (è€ƒå‰ 1 ä¸ªæœˆ)
                            </h3>
                            <p class="text-[10px] text-slate-400">å…¨çœŸæ¨¡æ‹Ÿç¯å¢ƒä¸‹ï¼Œè¿›è¡Œç‰©ç†ä¹¦å†™è§„èŒƒæ€§çš„é—­ç¯ä¿®æ­£ã€‚</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Footer Section -->
            <div class="bg-slate-900 rounded-[2.5rem] p-10 text-white relative overflow-hidden text-center">
                <div
                    class="absolute inset-0 opacity-10 bg-[radial-gradient(circle_at_center,_white_1px,_transparent_1px)] bg-[size:20px_20px]">
                </div>
                <div class="relative z-10">
                    <p class="text-[9px] font-bold text-blue-400 tracking-[0.4em] mb-4">PRACTICAL SUPPORT</p>
                    <h3 class="text-xl font-black mb-6">æƒ³è·å¾—ä¸“å±çš„ã€å·é¢å¤ç›˜å»ºè®®ã€‘å—ï¼Ÿ</h3>
                    <p class="text-xs text-slate-400 mb-10 max-w-sm mx-auto leading-relaxed">
                        ç§‹ç§‹åŒå­¦ç‰©ç†ç»„å°†åŸºäºå­©å­çš„æ¨¡æ‹Ÿè€ƒè¯•å·é¢ï¼Œè¾“å‡ºä¸€ä»½åŠ¡å®çš„è¯Šæ–­å»ºè®®ï¼Œå¹¶å¸Œæœ›èƒ½é€šè¿‡ 1:1 é¢è°ˆå®å®åœ¨åœ¨åœ°å¸®ä»–è§£å†³ç‚¹é—®é¢˜ã€‚
                    </p>
                    <button onclick="copyWechat(); closeTemplate();"
                        class="bg-blue-600 px-10 py-4 rounded-2xl font-black text-xs shadow-2xl shadow-blue-500/40 active:scale-95 transition-all">
                        ç«‹å³è”ç³»è€å¸ˆï¼šè¿›è¡Œå·é¢å¤ç›˜
                    </button>
                    <p class="text-[8px] text-slate-600 mt-6 font-medium">Â© 2026 QIUQIU EDUCATION GROUP Â· ç§‹ç§‹åŒå­¦</p>
                </div>
            </div>
        </div>
    </div>

    <div id="eduModal" class="fixed inset-0 bg-white/90 backdrop-blur-md z-[180] hidden items-center justify-center p-6">
        <div class="w-full max-w-md glass-card p-6 modal-animation overflow-hidden relative">
            <div class="flex items-center justify-between mb-4">
                <div class="flex items-center">
                    <div class="w-1 h-4 bg-blue-600 rounded-full mr-2"></div>
                    <span class="text-slate-800 font-black tracking-widest text-sm uppercase">Education Ranking</span>
                </div>
                <button type="button" onclick="closeEduModal()"
                    class="w-8 h-8 rounded-full bg-slate-100 text-slate-700 flex items-center justify-center hover:bg-slate-200 transition-all">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                    </svg>
                </button>
            </div>

            <div class="text-xs font-extrabold text-slate-700 mb-3 tracking-wider">å®‰å¾½çœå„åœ°å¸‚æ•™è‚²æ°´å¹³ç»¼åˆæ’åï¼ˆé«˜â†’ä½ï¼‰</div>
<div class="space-y-2 text-sm font-extrabold text-slate-800">
    <div class="flex items-center justify-between p-3 rounded-2xl bg-slate-50 border border-slate-100">
        <span>1. åˆè‚¥å¸‚</span><span class="text-slate-400 text-xs font-black tracking-widest">Top</span>
    </div>
    <div class="flex items-center justify-between p-3 rounded-2xl bg-slate-50 border border-slate-100">
        <span>2. èŠœæ¹–å¸‚</span><span class="text-slate-400 text-xs font-black tracking-widest">A</span>
    </div>
    <div class="flex items-center justify-between p-3 rounded-2xl bg-slate-50 border border-slate-100">
        <span>3. èšŒåŸ å¸‚</span><span class="text-slate-400 text-xs font-black tracking-widest">A</span>
    </div>
    <div class="flex items-center justify-between p-3 rounded-2xl bg-slate-50 border border-slate-100">
        <span>4. é©¬éå±±å¸‚</span><span class="text-slate-400 text-xs font-black tracking-widest">B</span>
    </div>
    <div class="flex items-center justify-between p-3 rounded-2xl bg-slate-50 border border-slate-100">
        <span>5. å®‰åº†å¸‚</span><span class="text-slate-400 text-xs font-black tracking-widest">B</span>
    </div>
    <div class="flex items-center justify-between p-3 rounded-2xl bg-slate-50 border border-slate-100">
        <span>6. é“œé™µå¸‚</span><span class="text-slate-400 text-xs font-black tracking-widest">B</span>
    </div>
    <div class="flex items-center justify-between p-3 rounded-2xl bg-slate-50 border border-slate-100">
        <span>7. æ»å·å¸‚</span><span class="text-slate-400 text-xs font-black tracking-widest">C</span>
    </div>
    <div class="flex items-center justify-between p-3 rounded-2xl bg-slate-50 border border-slate-100">
        <span>8. é˜œé˜³å¸‚</span><span class="text-slate-400 text-xs font-black tracking-widest">C</span>
    </div>
    <div class="flex items-center justify-between p-3 rounded-2xl bg-slate-50 border border-slate-100">
        <span>9. å®¿å·å¸‚</span><span class="text-slate-400 text-xs font-black tracking-widest">C</span>
    </div>
    <div class="flex items-center justify-between p-3 rounded-2xl bg-slate-50 border border-slate-100">
        <span>10. å…­å®‰å¸‚</span><span class="text-slate-400 text-xs font-black tracking-widest">C</span>
    </div>
    <div class="flex items-center justify-between p-3 rounded-2xl bg-slate-50 border border-slate-100">
        <span>11. å®£åŸå¸‚</span><span class="text-slate-400 text-xs font-black tracking-widest">C</span>
    </div>
    <div class="flex items-center justify-between p-3 rounded-2xl bg-slate-50 border border-slate-100">
        <span>12. æ·®å—å¸‚</span><span class="text-slate-400 text-xs font-black tracking-widest">D</span>
    </div>
    <div class="flex items-center justify-between p-3 rounded-2xl bg-slate-50 border border-slate-100">
        <span>13. æ·®åŒ—å¸‚</span><span class="text-slate-400 text-xs font-black tracking-widest">D</span>
    </div>
    <div class="flex items-center justify-between p-3 rounded-2xl bg-slate-50 border border-slate-100">
        <span>14. äº³å·å¸‚</span><span class="text-slate-400 text-xs font-black tracking-widest">D</span>
    </div>
    <div class="flex items-center justify-between p-3 rounded-2xl bg-slate-50 border border-slate-100">
        <span>15. æ± å·å¸‚</span><span class="text-slate-400 text-xs font-black tracking-widest">D</span>
    </div>
    <div class="flex items-center justify-between p-3 rounded-2xl bg-slate-50 border border-slate-100">
        <span>16. é»„å±±å¸‚</span><span class="text-slate-400 text-xs font-black tracking-widest">D</span>
    </div>
</div>


            <div class="mt-4 text-[10px] text-slate-400 font-bold leading-relaxed tracking-widest">
                <div>ä¾æ®ï¼šé«˜è€ƒäººæ•°ã€é«˜æ•™èµ„æºã€é«˜ä¸­å®åŠ›ã€ä¹‰åŠ¡æ•™è‚²å‡è¡¡åº¦ç­‰ç»´åº¦æ±‡æ€»ã€‚</div>
                <div>ç”¨é€”ï¼šä»…ä½œä¸ºæ¢ç®—è½»é‡ä¿®æ­£ï¼ˆÂ±4%å†…ï¼‰ï¼Œåé¦ˆè¶Šå¤šé¢„æµ‹è¶Šå‡†ã€‚</div>
            </div>

            <button type="button" onclick="closeEduModal()"
                class="w-full mt-5 py-4 rounded-2xl bg-blue-600 text-white font-black tracking-widest shadow-lg shadow-blue-200 active:scale-95 transition-all">
                çŸ¥é“äº†
            </button>
        </div>
    </div>

    <!-- AI Roast Modal -->
    <div id="roastModal"
        class="fixed inset-0 bg-[#0f172a]/95 backdrop-blur-xl z-[200] hidden overflow-y-auto p-6 flex-col items-center">
        <div class="w-full max-w-md">
            <div class="flex justify-between items-center mb-8">
                <div
                    class="bg-rose-500 text-white px-3 py-1 rounded-md text-[10px] font-black uppercase tracking-tighter shadow-[0_0_15px_rgba(244,63,94,0.5)]">
                    Anti-Chicken Soup Zone</div>
                <button onclick="closeRoastModal()" class="text-slate-400 hover:text-white transition-colors">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12">
                        </path>
                    </svg>
                </button>
            </div>

            <header class="text-center mb-10">
                <h2 class="text-3xl font-black text-white roast-glitch mb-2">AI æ¯’èˆŒæµ‹è¯„ç³»ç»Ÿ</h2>
                <p class="text-slate-500 text-xs font-medium">â€”â€” ç§‹ç§‹åŒå­¦ç‰¹åˆ«ç­–åˆ’ï¼šä¸“æ²»å„ç§è€ƒè¯•ä¸æœ â€”â€”</p>
            </header>

            <div id="roastFormArea">
                <p class="text-[10px] text-slate-400 mb-6 text-center">è¾“å…¥å…¨ç§‘åˆ†æ•°ï¼Œé¢†é˜…æœ€çº¯æ­£çš„é«˜è€ƒæ‰å¿ƒåæ§½</p>
                <div class="grid grid-cols-2 gap-4 mb-6">
                    <div class="space-y-4">
                        <input type="number" id="r_yw" placeholder="è¯­æ–‡"
                            class="w-full bg-slate-800 border-none rounded-xl p-4 text-white text-sm font-bold focus:ring-2 focus:ring-rose-500 outline-none">
                        <input type="number" id="r_sx" placeholder="æ•°å­¦"
                            class="w-full bg-slate-800 border-none rounded-xl p-4 text-white text-sm font-bold focus:ring-2 focus:ring-rose-500 outline-none">
                        <input type="number" id="r_yy" placeholder="è‹±è¯­"
                            class="w-full bg-slate-800 border-none rounded-xl p-4 text-white text-sm font-bold focus:ring-2 focus:ring-rose-500 outline-none">
                    </div>
                    <div class="space-y-4">
                        <input type="number" id="r_x1" placeholder="ç‰©ç† / å†å²"
                            class="w-full bg-slate-800 border-none rounded-xl p-4 text-white text-sm font-bold focus:ring-2 focus:ring-rose-500 outline-none">
                        <input type="number" id="r_x2" placeholder="å†é€‰ A (åŒ–/ç”Ÿ/åœ°/æ”¿)"
                            class="w-full bg-slate-800 border-none rounded-xl p-4 text-white text-[10px] font-bold focus:ring-2 focus:ring-rose-500 outline-none">
                        <input type="number" id="r_x3" placeholder="å†é€‰ B (åŒ–/ç”Ÿ/åœ°/æ”¿)"
                            class="w-full bg-slate-800 border-none rounded-xl p-4 text-white text-[10px] font-bold focus:ring-2 focus:ring-rose-500 outline-none">
                    </div>
                </div>
                <button onclick="generateRoast()"
                    class="w-full bg-rose-600 hover:bg-rose-500 text-white font-black py-4 rounded-xl shadow-lg shadow-rose-900/40 transition-all active:scale-95">
                    çœ‹çœ‹åˆ°åº•æœ‰å¤šæ‰å¿ƒ
                </button>
            </div>

            <!-- Roast Result Display (Hidden initially) -->
            <div id="roastResultArea" class="hidden animate-modalEnter">
                <div class="roast-card p-4 border-2 border-rose-500/30 mb-8 relative">
                    <div
                        class="absolute -top-3 -left-2 bg-rose-600 text-[8px] font-black px-2 py-0.5 rounded text-white">
                        SYSTEM ROASTING...</div>
                    <div class="text-rose-400 font-mono text-xs mb-4">>>> DECODING BRAIN CAPACITY...</div>
                    <p id="roastText" class="text-lg font-black text-rose-50 text-justify leading-relaxed mb-6 italic">
                        ---</p>
                    <div class="text-right">
                        <p class="text-[8px] text-slate-500 italic opacity-60">â€”â€” æ¥è‡ª ç§‹ç§‹åŒå­¦ AI æ¯’èˆŒå¼•æ“</p>
                    </div>
                </div>

                <div class="bg-white/5 p-4 rounded-2xl mb-8 flex items-center justify-between">
                    <div class="text-left">
                        <p class="text-[10px] text-slate-400 leading-relaxed">
                            è™½ç„¶åœ¨æ‰ä½ ï¼Œä½†è¿˜æ˜¯å¸Œæœ›ä½ èƒ½å¥½ã€‚<br>
                            <span class="text-rose-500 font-bold">ç”Ÿæˆä¸“å±åˆ†äº«å›¾ï¼Œè®©å¥½åŸºå‹ä¹Ÿæ¸…é†’ä¸€ä¸‹ï¼Ÿ</span>
                        </p>
                    </div>
                    <button onclick="captureRoast()"
                        class="bg-rose-600 p-3 rounded-xl hover:bg-rose-500 transition-colors shadow-lg shadow-rose-900/40">
                        <svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"></path>
                        </svg>
                    </button>
                </div>

                <!-- [VIBE UPGRADE] Trendy Share Card for 08-borns -->
                <!-- [VIBE UPGRADE] Trendy Share Card for 08-borns -->
                <!-- Wrap in a hidden container that doesn't use -left-[9999px] for better canvas calculation -->
                <div
                    style="position: absolute; top: 0; left: 0; width: 0; height: 0; overflow: hidden; pointer-events: none;">
                    <div id="shareCard" class="bg-[#020617] p-0 overflow-hidden font-['Outfit']" style="width: 420px;">
                        <!-- Top Dynamic Stripe -->
                        <div class="h-2 w-full bg-gradient-to-r from-rose-500 via-indigo-500 to-cyan-400"></div>

                        <div class="p-10">
                            <!-- Header: Sticker Style -->
                            <div class="relative mb-12">
                                <div
                                    class="absolute -top-4 -left-4 rotate-[-10deg] bg-rose-600 text-white px-3 py-1 text-[9px] font-black tracking-widest rounded shadow-xl z-20">
                                    ANTI-CHICKEN SOUP
                                </div>
                                <div class="flex flex-col">
                                    <!-- REMOVED bg-clip-text for html2canvas compatibility -->
                                    <h2 class="text-[44px] leading-[0.9] font-black text-white italic uppercase">
                                        Roast<br><span class="text-rose-500">System</span>
                                    </h2>
                                    <p
                                        class="text-[8px] text-slate-500 font-bold tracking-[0.4em] mt-2 border-l-2 border-rose-500 pl-2">
                                        QIUQIU Â· AI æ¯’èˆŒæµ‹è¯„ç³»ç»Ÿ 2.0
                                    </p>
                                </div>
                                <div class="absolute top-0 right-0 text-right">
                                    <span class="text-[40px] font-black text-rose-500/10 leading-none">08#</span>
                                </div>
                            </div>

                            <!-- Main Content: Card -->
                            <div class="share-gradient-border mb-12 shadow-2xl">
                                <div class="bg-[#0f172a] rounded-[22px] p-8 relative overflow-hidden">
                                    <div class="flex items-center space-x-2 mb-6 opacity-60">
                                        <div class="flex space-x-1">
                                            <div class="w-1.5 h-1.5 rounded-full bg-rose-500"></div>
                                            <div class="w-1.5 h-1.5 rounded-full bg-amber-500"></div>
                                            <div class="w-1.5 h-1.5 rounded-full bg-emerald-500"></div>
                                        </div>
                                        <span class="text-[8px] font-mono text-slate-400 tracking-tighter uppercase">
                                            paper-fault-trace // analysis.exe</span>
                                    </div>

                                    <p id="shareRoastText"
                                        class="text-[26px] font-black text-white leading-[1.3] mb-10 tracking-tight">
                                        å½•å–æ³¢åŠ¨å¾ˆå¤§ï¼Œä½ çš„å¿ƒè·³æ¯”åˆ†æ•°çº¿è¿˜ç¨³ã€‚è¿™åˆ†æ•°å»å“ªéƒ½æ˜¯â€œé‡åœ¨å‚ä¸â€ã€‚
                                    </p>

                                    <div class="flex items-center justify-between border-t border-white/5 pt-6">
                                        <p class="text-[9px] font-bold text-slate-500 italic uppercase">Generated by
                                            Qiuqiu AI Core</p>
                                        <div
                                            class="px-2 py-0.5 bg-rose-500/10 border border-rose-500/20 rounded text-[8px] font-black text-rose-500 uppercase tracking-widest">
                                            Toxic Level: MAX
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Footer: Viral Growth Section -->
                            <div class="flex items-end justify-between">
                                <div class="flex-1 pr-6 pb-2">
                                    <div class="mb-4">
                                        <p class="text-xs font-black text-white mb-1" id="shareRoastLabel">2026å®‰å¾½çœæ¨¡æ‹Ÿè€ƒè¯•Â·å®˜æ–¹å¯¹æ ‡</p>
                                        <div class="h-0.5 w-12 bg-rose-500"></div>
                                    </div>
                                    <p class="text-[10px] text-slate-500 leading-relaxed font-bold">
                                        é•¿æŒ‰è¯†åˆ«äºŒç»´ç  â†’<br>
                                        <span class="text-slate-300">ç«‹åˆ»é¢†å–ä½ çš„å¤ç›˜æŠ¥å‘Š & æ•‘å‘½å»ºè®®</span>
                                    </p>
                                </div>
                                <div class="relative">
                                    <div
                                        class="absolute -inset-2 bg-gradient-to-tr from-rose-500 to-cyan-400 rounded-2xl blur-md opacity-30">
                                    </div>
                                    <div class="relative w-24 h-24 bg-white p-2 rounded-2xl shadow-2xl">
                                        <img id="qrCode" src="qrcode_official.png" alt="QR" crossorigin="anonymous" class="w-full h-full">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="flex space-x-3">
                    <button id="roastCloseBtn" onclick="closeRoastModal()"
                        class="flex-1 bg-slate-800 text-slate-300 py-3 rounded-xl text-xs font-bold">ä¸çœ‹äº†ï¼Œå¿ƒç¢äº†</button>
                    <button id="roastHelpBtn" onclick="roastCopyWechat()"
                        class="flex-1 bg-white text-slate-900 py-3 rounded-xl text-xs font-black shadow-xl">æ‰¾è€å¸ˆæ±‚æ•‘</button>
                </div>
            </div>
        </div>
        <!-- Roast Alert Modal (Custom Notification) -->
        <div id="roastAlertModal"
            class="fixed inset-0 bg-[#020617]/95 backdrop-blur-lg z-[300] hidden items-center justify-center p-8">
            <div
                class="w-full max-w-xs bg-slate-900 border border-white/10 rounded-[40px] p-8 shadow-2xl animate-modalEnter">
                <div class="mb-6 flex justify-center">
                    <div class="w-16 h-16 bg-rose-500/20 rounded-full flex items-center justify-center">
                        <svg class="w-8 h-8 text-rose-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                        </svg>
                    </div>
                </div>
                <h3 id="roastAlertTitle" class="text-xl font-black text-rose-50 text-center mb-4 italic">Message</h3>
                <div class="bg-white/5 rounded-2xl p-4 mb-6 border border-white/5">
                    <p class="text-[10px] text-slate-500 text-center mb-1 uppercase tracking-widest font-bold">å¾®ä¿¡å· (å·²å¤åˆ¶)
                    </p>
                    <p class="text-2xl font-black text-white text-center tracking-wider">A15655736069</p>
                </div>
                <p id="roastAlertContent" class="text-slate-400 text-xs leading-relaxed text-center mb-8 font-medium">
                    å†…å®¹åŠ è½½ä¸­...
                </p>
                <button onclick="closeRoastAlert()"
                    class="w-full bg-rose-600 text-white font-black py-4 rounded-2xl shadow-lg shadow-rose-900/40 active:scale-95 transition-all flex items-center justify-center space-x-2">
                    <span>å·²å¤åˆ¶ï¼Œå»å¾®ä¿¡ç²˜è´´æœç´¢</span>
                    <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                        <path
                            d="M10.293 3.293a1 1 0 011.414 0l6 6a1 1 0 010 1.414l-6 6a1 1 0 01-1.414-1.414L14.586 11H3a1 1 0 110-2h11.586l-4.293-4.293a1 1 0 010-1.414z">
                        </path>
                    </svg>
                </button>
            </div>
        </div>

        <script src="database.js"></script>
        <script>
            // ... (Existing script remains same until end)
            function openRoastModal() {
                document.getElementById('roastModal').classList.remove('hidden');
                document.getElementById('roastModal').classList.add('flex');
                document.body.style.overflow = 'hidden';
                // Default reset
                document.getElementById('roastFormArea').classList.remove('hidden');
                document.getElementById('roastResultArea').classList.add('hidden');
            }

            function closeRoastModal() {
                document.getElementById('roastModal').classList.add('hidden');
                document.getElementById('roastModal').classList.remove('flex');
                document.body.style.overflow = 'auto';
            }

            function openEduModal() {
                const el = document.getElementById('eduModal');
                if (!el) return;
                el.classList.remove('hidden');
                el.classList.add('flex');
                document.body.style.overflow = 'hidden';
            }

            function closeEduModal() {
                const el = document.getElementById('eduModal');
                if (!el) return;
                el.classList.add('hidden');
                el.classList.remove('flex');
                document.body.style.overflow = 'auto';
            }

            function getRoastCityInfo() {
                const sel = document.getElementById('city');
                const cityKey = sel && sel.value ? sel.value : '';
                let name = 'å®‰å¾½çœ';
                if (typeof CITY_META !== 'undefined' && cityKey && CITY_META[cityKey] && CITY_META[cityKey].name) {
                    name = CITY_META[cityKey].name;
                }
                const short = name.replace(/(å¸‚|å·)$/, '');
                return { cityKey, name, short };
            }

            function applyRoastCityCopy(text) {
                const { name, short } = getRoastCityInfo();
                const cityName = name || 'å®‰å¾½çœ';
                const cityShort = short || 'å®‰å¾½';
                let t = String(text || '');
                t = t.replace(/åˆè‚¥æ¨¡æ‹Ÿè€ƒè¯•/g, `${cityShort}æ¨¡æ‹Ÿè€ƒè¯•`);
                t = t.replace(/åˆè‚¥å¸‚/g, cityName);
                t = t.replace(/åˆè‚¥/g, cityShort);
                return t;
            }

            function generateRoast() {
                const yw = parseFloat(document.getElementById('r_yw').value) || 0;
                const sx = parseFloat(document.getElementById('r_sx').value) || 0;
                const yy = parseFloat(document.getElementById('r_yy').value) || 0;
                const x1 = parseFloat(document.getElementById('r_x1').value) || 0;
                const x2 = parseFloat(document.getElementById('r_x2').value) || 0;
                const x3 = parseFloat(document.getElementById('r_x3').value) || 0;
                const x_total = x1 + x2 + x3;
                const total = yw + sx + yy + x_total;

                const roasts = {
                    super_god: [ // 705+
                        "å»ºè®®ç›´æ¥æŠŠä½ çš„å¤§è„‘æç»™å›½å®¶ï¼Œç•™åœ¨è¿™é‡Œå‚åŠ è€ƒè¯•çº¯å±æ˜¯é™ç»´æ‰“å‡»ã€‚",
                        "å·ç‹å·²ç»æ— æ³•å½¢å®¹ä½ äº†ï¼Œä½ æ˜¯å·åŸºå»ºï¼Œä½ æ˜¯å·æ–‡æ˜ã€‚å»ºè®®ç›´æ¥ç”³è¯·ä»åœ°çƒé€€ä¼‘ã€‚",
                        "ä½ è€ƒè¿™ä¸ªåˆ†ï¼Œæ˜¯ä¸ºäº†è¯æ˜é˜…å·ç³»ç»Ÿæ²¡åå—ï¼Ÿæ¸…åçš„æ ¡å‹å½•å»ºè®®æå‰æŠŠä½ åå­—åˆ»ä¸Šå»ã€‚",
                        "è¿™ç§åˆ†æ•°ï¼Œèµ°åœ¨å‰å¤§çš„è·¯ä¸Šï¼ŒçŸ³å¤´éƒ½èƒ½ç»™ä½ å¼€å‡ºèŠ±æ¥ã€‚è¯·é—®ä½ å¹³æ—¶å–çš„æ˜¯98å·æ±½æ²¹å—ï¼Ÿ",
                        "ä½ çš„å­˜åœ¨è®©â€˜åŠªåŠ›â€™è¿™ä¸ªè¯æ˜¾å¾—éå¸¸è‹ç™½ã€‚å»ºè®®å»ç«æ˜Ÿæ®–æ°‘ï¼Œåœ°çƒå·²ç»è£…ä¸ä¸‹ä½ çš„æ™ºå•†äº†ã€‚"
                    ],
                    god: [ // 670-705
                        "ç¨³å¦‚ç‹—çš„é¡¶çº§ç²¾è‹±ã€‚å»ºè®®æå‰å»ç»ƒä¹ ä¸€ä¸‹å¤§å‚çš„æ—©æ“ï¼Œæ¯•ç«Ÿæœªæ¥çš„985é¡¶çº§æ‰“å·¥äººï¼Œä½“åŠ›ä¹Ÿå¾—è·Ÿä¸Šã€‚",
                        "ä½ æ˜¯åˆ·é¢˜åˆ·å‡ºäº†å¹»è§‰å—ï¼Ÿè¿™æˆç»©ç¨³å¾—åƒå‡çš„ä¸€æ ·ï¼Œå»ºè®®å»çœ‹ä¸ªä¸­åŒ»ï¼Œè¡¥è¡¥â€˜ä¸å·ä¼šæ­»â€™çš„å…ƒæ°”ã€‚",
                        "è¿™ç§é€‰æ‰‹ç›´æ¥ä¿é€å¾—äº†ï¼Œè¿˜è€ƒä»€ä¹ˆè¯•ï¼Ÿç®€ç›´å°±æ˜¯å¯¹é˜…å·è€å¸ˆä½“åŠ›çš„äºµæ¸ã€‚",
                        "ä½ è¿™åˆ†æ•°æ‹¿å‡ºæ¥ï¼Œå…¨ç­çš„å¹³å‡åˆ†éƒ½è¢«ä½ æ‹½åˆ°äº†ä¸å±äºå®ƒçš„é«˜åº¦ã€‚å°å¿ƒæ”¾å­¦è¢«åŒå­¦â€˜æŸ¥æˆ·å£â€™ã€‚",
                        "é«˜è€ƒå¯¹ä½ æ¥è¯´å¯èƒ½åªæ˜¯èµ°ä¸ªè¿‡åœºï¼Œå»ºè®®ç›´æ¥è”ç³»é¡¶çº§åæ ¡ï¼Œé‚£é‡Œçš„å†·æ°”æ›´é€‚åˆä½ çš„å†·é™ã€‚"
                    ],
                    math_god_total_low: [ // æ•°å­¦142+ æ€»åˆ†ä½
                        "æ•°å­¦è€ƒå¾—åƒä¸ªæˆ˜ç¥ï¼Œæ€»åˆ†åƒä¸ªéš¾æ°‘ã€‚ä½ æ˜¯å‡†å¤‡ä»¥åç”¨å¯¼æ•°å»æ¨å¯¼ä½ åœ¨å·¥åœ°æ¬ç –çš„æŠ›ç‰©çº¿å—ï¼Ÿ",
                        "é€»è¾‘è„‘é•¿åˆ°äº†æé™ï¼Œè¯­è¨€è„‘å¤§æ¦‚æ˜¯æ¬ è´¹äº†ã€‚ä½ è¿™ç§åç§‘æ³•ï¼Œå»ºè®®å»å½“AIçš„åº•å±‚æ¶æ„ï¼Œåˆ«è·Ÿäººç±»è¯´è¯äº†ã€‚",
                        "æ•°å­¦140+ï¼Œè‹±è¯­ä¸åŠæ ¼ï¼Ÿä½ å¤§æ¦‚æ˜¯ä¸Šè¾ˆå­è¢«èå£«æ¯”äºšä¼¤å®³è¿‡ï¼Œè¿™è¾ˆå­ä¸“é—¨æ¥ç”¨æ•°å­—å¤ä»‡çš„å§ï¼Ÿ",
                        "ä½ çš„å¤§è„‘æ˜¯å•æ ¸CPUå—ï¼Ÿå…¨æŠŠç®—åŠ›åˆ†é…ç»™æ•°å­¦äº†ï¼Œå…¶ä»–ç§‘ç›®éƒ½åœ¨é‚£å„¿è½¬åœˆå‘¢ï¼Ÿ"
                    ],
                    math_fail: [ // æ•°å­¦æä½
                        `æ•°å­¦è€ƒ${sx}ï¼Ÿè¿™æ™ºåŠ›å¦‚æœæ˜¯ä½™é¢çš„è¯ï¼Œè¿å…±äº«å•è½¦éƒ½æ‰«ä¸åŠ¨ã€‚å»ºè®®å»ç»ƒç»ƒé•¿è·‘ï¼Œé€Ÿåº¦æ˜¯ä½ å”¯ä¸€çš„é€€è·¯ã€‚`,
                        "æ•°å­¦è€å¸ˆçœ‹åˆ°è¿™å¼ å·å­ï¼Œå¯èƒ½ä¼šå½“åœºåŸåœ°é€€ä¼‘ï¼Œå¹¶è¿å¤œæ³¨é”€è‡ªå·±çš„æ•™å¸ˆèµ„æ ¼è¯ã€‚",
                        `æ•°å­¦${sx}åˆ†ï¼Œä½ æ˜¯æ€ä¹ˆåšåˆ°åœ¨é¿å¼€æ‰€æœ‰æ­£ç¡®é€‰é¡¹çš„åŒæ—¶ï¼Œè¿˜ç²¾å‡†è¸©ä¸­æ‰€æœ‰é›·åŒºçš„ï¼Ÿè¿™ä¹Ÿæ˜¯ä¸€ç§å¤©èµ‹ã€‚`,
                        "ä½ çš„æ•°å­¦å·å­è®©æˆ‘çœ‹åˆ°äº†å®‡å®™çš„è™šæ— ï¼Œé™¤äº†å¤§é¢˜å¼€å¤´çš„â€˜è§£â€™å­—ï¼Œå‰©ä¸‹çš„å…¨æ˜¯â€˜ç©ºè™šâ€™ã€‚",
                        "å»ºè®®æŠŠæ•°å­¦ä¹¦çƒ§äº†å–æš–ï¼Œè‡³å°‘é‚£æ ·å®ƒè¿˜èƒ½äº§ç”Ÿç‚¹çƒ­é‡ã€‚æŒ‡æœ›å®ƒäº§ç”Ÿåˆ†æ•°ï¼Œä½ æ˜¯æƒ³å¤šäº†ã€‚"
                    ],
                    english_god_fail: [ // è‹±è¯­æé«˜æ€»åˆ†ä½
                        "è‹±è¯­è€ƒå¾—æŒºæ¬¢å®ï¼Œæ˜¯ä¸ºäº†ä»¥åç«¯ç›˜å­æ—¶èƒ½å¬æ‡‚å¤–å›½è€æ¿æ€ä¹ˆéª‚ä½ å—ï¼Ÿè¿™ç§â€˜åç§‘åˆ°å§¥å§¥å®¶â€™çš„èŠ‚å¥ï¼Œä¸å»å½“ç¿»è¯‘å®˜å¯æƒœäº†ã€‚",
                        "æ»¡è„‘å­ä¼¦æ•¦è…”ï¼Œæ‰‹é‡Œæ‹¿ç€ä¸åŠæ ¼çš„æ•°å­¦å·ã€‚ä½ è¿™æ˜¯å‡†å¤‡å»ç‰›æ´¥å¤§å­¦å½“é—¨å«ï¼Œè¿˜æ˜¯å»å‰‘æ¡¥å¤§å­¦æ‰«è½å¶ï¼Ÿ",
                        "è‹±è¯­å¥½åˆ°é£èµ·ï¼Œæ€»åˆ†æƒ¨ä¸å¿ç¹ã€‚ä½ å¤§æ¦‚æ˜¯ä¸Šå¸æ´¾æ¥çš„å’Œå¹³ä½¿è€…ï¼Œç”¨å¤–è¯­å‘å…¨ä¸–ç•Œä¼ è¾¾ä½ ä¸æƒ³å­¦ä¹ çš„ä¿¡å·ã€‚",
                        "è¿™è‹±è¯­æ°´å¹³å»ºè®®ç›´æ¥ç§»æ°‘ï¼Œæ¯•ç«Ÿç•™åœ¨å›½å†…ï¼Œè¿™æ€»åˆ†è¿è‡ªè´¹æœ¬ç§‘çš„è¾¹éƒ½æ‘¸ä¸åˆ°ã€‚",
                        "ä½ æ˜¯æ‰“ç®—ä»¥åé ç¿»è¯‘â€˜Sorry, I didn't studyâ€™è¿™å¥è¯æ¥åº¦è¿‡ä½™ç”Ÿå—ï¼Ÿ"
                    ],
                    invisible_mid: [ // 580-670 éšå½¢ä¸­å±‚
                        "å¹³åº¸åˆ°è¿AIéƒ½æ‡’å¾—åæ§½ã€‚ä½ å°±åƒæ‰‹æœºç³»ç»Ÿè‡ªå¸¦çš„è®¡ç®—å™¨ï¼Œæœ‰ç”¨ï¼Œä½†å¹¶æ²¡æœ‰äººçœŸçš„å…³å¿ƒä½ çš„å­˜åœ¨ã€‚",
                        "ä½ è¿™ç±»å­¦ç”Ÿæ˜¯æ•™è‚²å±€çš„æœ€çˆ±â€”â€”å› ä¸ºä½ å®Œç¾åœ°ç»´æŒäº†ç»Ÿè®¡æ•°æ®çš„ç¨³å®šæ€§ï¼Œä¸å¤šä¸å°‘ï¼Œåˆšå¥½â€˜è·¯äººç”²â€™ã€‚",
                        "æ¨¡æ‹Ÿè€ƒè¯•è€ƒå‡ºè¿™ç§â€˜ç¨³å¦‚è€ç‹—â€™çš„ä¸­åº¸åˆ†æ•°ï¼Œä½ æ˜¯åœ¨ç»™æœªæ¥çš„å¹³å‡¡ç”Ÿæ´»é¢„æ¼”æ’ç»ƒå—ï¼Ÿå»ºè®®æå‰ç»ƒä¹ ä¸€ä¸‹å¦‚ä½•ä¼˜é›…åœ°æŒ¤åœ°é“ã€‚",
                        "ä½ çš„äººç”Ÿä¸»æ‰“ä¸€ä¸ªâ€˜é‡åœ¨å‚ä¸â€™ã€‚åœ¨å·ç‹å’Œå­¦æ¸£ä¹‹é—´å®Œç¾éšèº«ï¼Œä½ æ˜¯æ€ä¹ˆåšåˆ°è¡¨è¾¾å¾—è¿™ä¹ˆå¹³åº¸çš„ï¼Ÿ",
                        "è€ƒå‡ºè¿™ç§åˆ†æ•°çš„ä½ ï¼Œæ—¢æ²¡æœ‰èµ„æœ¬ç‹‚å¦„ï¼Œä¹Ÿæ²¡æœ‰å€Ÿå£é¢“åºŸï¼Œåªèƒ½åœ¨ç„¦è™‘ä¸­åå¤æ¨ªè·³ã€‚"
                    ],
                    struggling_mid: [ // 480-580 æŒ£æ‰åŒº
                        "è¿™ä¸ªåˆ†æ•°å°±åƒç™½å¼€æ°´ï¼Œå–äº†ä¸è§£æ¸´ï¼Œå€’äº†åˆæœ‰ç‚¹å¯æƒœã€‚å»ºè®®ç»™è‡ªå·±æ‰¾ä¸ªé—ªå…‰ç‚¹ï¼Œå“ªæ€•æ˜¯å¤´å‘å¤šä¹Ÿè¡Œã€‚",
                        "ä½ åœ¨åŠæ ¼çš„è¾¹ç¼˜ç–¯ç‹‚æ¨ªè·³ï¼ŒåŠ¨ä½œå¾ˆä¼˜ç¾ï¼Œä½†æˆç»©å¾ˆéª¨æ„Ÿã€‚å»ºè®®æ‰¾ä¸ªç¨³ä¸€ç‚¹çš„é‡å¿ƒï¼Œåˆ«è·³æ°´é‡Œäº†ã€‚",
                        "ä½ è¿™ç§ä¸¢åˆ†æ–¹å¼ï¼Œä¸»æ‰“ä¸€ä¸ªâ€˜é›¨éœ²å‡æ²¾â€™ã€‚å¯¹æ¯ä¸ªå­¦ç§‘æœ€å¤§çš„å…¬å¹³ï¼Œå°±æ˜¯è®©å®ƒä»¬å…¨éƒ½è€ƒå¾—åŠæ­»ä¸æ´»ã€‚",
                        "è¿™æ˜¯ä¸€ä¸ªè®©å®¶é•¿æƒ³æ”¾å¼ƒã€è®©è€å¸ˆæƒ³å¹æ¯ã€è®©ä½ æƒ³æ‰“æ¸¸æˆçš„åˆ†æ•°ã€‚ä½ çœŸæ˜¯ä¸‰æ–¹çš„å¿ƒç†åšå¼ˆå¤§å¸ˆã€‚"
                    ],
                    danger_zone: [ // 380-480 å±é™©çº¿
                        "è¿™åˆ†æ•°åœ¨æœ¬ç§‘çº¿ä¸Šè¹¦è¿ªï¼Œä¸€ä¸ªä¸å°å¿ƒå°±æ‰è¿›å¤§ä¸“çš„å¤§å‘é‡Œã€‚å»ºè®®ä½ å…ˆæŠŠæ‰‹æœºå±ä¿æ¢æˆâ€˜æˆ‘çˆ±å­¦ä¹ â€™ï¼Œåˆ«å†è¿·æ‹æŠ–éŸ³äº†ã€‚",
                        "ä½ çš„æˆç»©è·Œå¾—æ¯”Aè‚¡è¿˜æƒ¨ï¼Œå”¯ä¸€çš„åŒºåˆ«æ˜¯Aè‚¡è¿˜æœ‰å¯èƒ½åå¼¹ï¼Œä½ çš„æ¨¡æ‹Ÿè€ƒè¯•å¤§æ¦‚ç‡åªèƒ½â€˜åçœâ€™ã€‚",
                        "ä½ æ˜¯å¸¦ç€â€˜ä½›ç³»â€™çš„å¿ƒæ€è¿›çš„è€ƒåœºå—ï¼Ÿç”±äºä½ å¤ªæ…ˆæ‚²ï¼Œå·å­ä¸Šçš„åˆ†æ•°å…¨éƒ½è¢«ä½ å¸ƒæ–½å‡ºå»äº†ã€‚",
                        "å»ºè®®ä»¥åè€ƒè¯•å¸¦ä¸¤æ ¹æ£’æ£’ç³–ï¼Œä¸€æ ¹ç»™è‡ªå·±è¡¥å……èƒ½é‡ï¼Œä¸€æ ¹å¡è¿›å„ç§‘è€å¸ˆå˜´é‡Œï¼Œé˜²æ­¢ä»–ä»¬éª‚å‡ºå£°ã€‚"
                    ],
                    low: [ // 320ä»¥ä¸‹
                        "è¿™åˆ†æ•°æ˜¯åœ¨æè¡Œä¸ºè‰ºæœ¯å—ï¼Ÿä½ ç¡®å®šæ‹¿çš„æ˜¯è¯•å·ï¼Œä¸æ˜¯ç»™é˜…å·è€å¸ˆå‡†å¤‡çš„â€˜è„‘ç˜«åº·å¤ä¸­å¿ƒâ€™å…¥åœºåˆ¸ï¼Ÿ",
                        "08å¹´çš„ä½ ï¼Œè¿™åˆ†æ•°æ˜¯åœ¨æå‰é¢„æ¼”â€˜ç¦»èŒå³é€€ä¼‘â€™çš„æ™šå¹´ç”Ÿæ´»å—ï¼Ÿå»ºè®®æå‰ç‰©è‰²ä¸€ä¸ªå®‰é™çš„å…¬å›­ï¼Œæ¯•ç«ŸæŠ¢åœ°ç›˜ä¹Ÿè¦è¶æ—©ã€‚",
                        "åˆ†æ•°è·Œç ´åœ°å¹³çº¿ï¼Œæˆ‘çœ‹ä½ è¿™ä¸æ˜¯æ¨¡æ‹Ÿè€ƒè¯•ï¼Œæ˜¯ç»™å…¨çœçš„å¹³å‡åˆ†è´¡çŒ®äº†ä¸€ä¸ªå·¨å¤§çš„é™·é˜±ã€‚",
                        "å­©å­ï¼Œè¿™åˆ†æ•°ç”šè‡³ä¸å¦‚ä½ èº«ä»½è¯å·çš„å‰ä¸‰ä½å¤§ï¼Œä½ åˆ°åº•æ˜¯åœ¨å’Œå·å­åšå¼ˆï¼Œè¿˜æ˜¯åœ¨å’Œè‡ªå·±çš„å‰é€”èµŒæ°”ï¼Ÿ",
                        "å¦‚æœé«˜è€ƒè€ƒçš„æ˜¯â€˜äººç±»ç¦»æ–‡æ˜æœ‰å¤šè¿œâ€™ï¼Œä½ ä¸€å®šæ˜¯ç¬¬ä¸€åã€‚è¿™ç§åŸå§‹æ„Ÿï¼ŒçœŸçš„å¾ˆè¿·äººã€‚"
                    ],
                    science_heavy: [ // é€‰ç§‘æå¼º
                        "ç†ç»¼å¼ºå¾—åƒæˆ˜ç¥ï¼Œè¯­æ•°å¤–å¼±å¾—åƒéš¾æ°‘ã€‚ä½ è¿™æ˜¯æ‰“ç®—ä»¥åç”¨ç‰›é¡¿å®šå¾‹å»è¯´æœHRç»™ä½ æ¶¨å·¥èµ„å—ï¼Ÿ",
                        "ç†åŒ–ç”Ÿæ»¡è¡€ï¼Œè¯­æ•°å¤–è´«è¡€ã€‚ä½ å’Œå¤§å­¦çš„è·ç¦»ï¼Œå¤§æ¦‚ä¸­é—´éš”ç€ä¸€ä¸ªå¤ªå¹³æ´‹çš„æ–‡ç§‘çŸ¥è¯†ã€‚",
                        "ç”±äºæ–‡ç§‘å¤ªå·®ï¼Œä½ å¯èƒ½æ— æ³•ç”¨ä¸­æ–‡å‡†ç¡®è¡¨è¾¾ä½ ç†ç§‘æœ‰å¤šç‰›ï¼Œè¿™å°±æ˜¯å…¸å‹çš„â€˜å“‘å·´æŠ€æœ¯å‘˜â€™ç§å­é€‰æ‰‹ã€‚",
                        "ç†ç§‘åˆ†åœ¨å¤©ï¼Œæ–‡ç§‘åˆ†åœ¨åœŸã€‚è¿™ç§ä¸¤æåˆ†åŒ–çš„ç¨‹åº¦ï¼Œå»ºè®®å»ç”³æŠ¥ç²¾ç¥åˆ†è£‚ç—‡ï¼ˆå¼€ç©ç¬‘ï¼‰ã€‚"
                    ],
                    arts_heavy: [ // è¯­ã€è‹±å¼º
                        "æ–‡ç§‘å¥½å¾—åƒè¯—äººï¼Œç†ç§‘çƒ‚å¾—åƒä¹±ç ã€‚ä½ æ˜¯æ‰“ç®—è€ƒç ”å»ä¿®ä»™ï¼Œè¿˜æ˜¯å‡†å¤‡å»ç”µå°è®²é¬¼æ•…äº‹ï¼Ÿ",
                        "ä½ çš„å¤§è„‘å¤§æ¦‚æ˜¯éš”ç¦»æ¨¡å¼ï¼Œå·¦è„‘è´Ÿè´£ä¼˜é›…çš„è¯æ±‡ï¼Œå³è„‘è´Ÿè´£å±è”½ä¸€åˆ‡é€»è¾‘è®¡ç®—ã€‚ä½ æ˜¯æ€ä¹ˆåšåˆ°è¿™ä¹ˆçº¯ç²¹çš„ï¼Ÿ",
                        "æ»¡çº¸è’å”è¨€ï¼Œä¸€æŠŠè¾›å‹¤æ³ªã€‚ä½ çš„æ–‡æ–™ç¡®å®æ¼‚äº®ï¼Œå¯æƒœç†ç§‘æ‹–åè…¿çš„é€Ÿåº¦ï¼Œè¿åšå°”ç‰¹éƒ½è¿½ä¸ä¸Šã€‚"
                    ],
                    perfect_balanced_low: [ // å…¨ä¸åŠæ ¼ä¸”åˆ†æ¥è¿‘
                        "å…­è¾¹å½¢æˆ˜å£«ï¼Œå¯æƒœæ¯æ¡è¾¹éƒ½çŸ­å¾—å‡ ä¹çœ‹ä¸è§ã€‚ä½ æ˜¯å‡†å¤‡ä»¥æ­¤ä¸ºæ¨¡æ¿å»å‚åŠ â€˜å…¨ç§‘æŒ‚ç§‘å¤§å¥–èµ›â€™å—ï¼Ÿ",
                        "å…¨ç§‘ç¨³å®šå‘æŒ¥â€”â€”åŒæ­¥ä¸åŠæ ¼ã€‚è¿™ç§èµ°é’¢ä¸çš„åè°ƒæ„Ÿï¼Œä¸å»æ‚æŠ€å›¢çœŸçš„å±ˆæ‰äº†ã€‚",
                        "ä½ çš„æ¯ä¸€ç§‘éƒ½åœ¨äº’ç›¸è¿å°±ï¼Œä¸»æ‰“ä¸€ä¸ªâ€˜å…±åŒå¯Œè£•ï¼Œä¸€èµ·è€ƒç ¸â€™ã€‚è¿™å¤§æ¦‚å°±æ˜¯å›¢é˜Ÿç²¾ç¥å§ã€‚"
                    ]
                };

                let roastText = "";
                if (total === 0) {
                    roastText = "åˆ†æ•°å¡«éƒ½ä¸æ•¢å¡«ï¼Ÿè¿™ç§å¿ƒç†æ‰¿å—èƒ½åŠ›ï¼Œå»ºè®®ç›´æ¥è·³è¿‡é«˜è€ƒï¼Œå»ç»ƒä¹ å¦‚ä½•ä¼˜é›…åœ°æ‰¿å—ç™½çœ¼ã€‚";
                } else if (total >= 705) {
                    roastText = roasts.super_god[Math.floor(Math.random() * roasts.super_god.length)];
                } else if (total >= 670) {
                    roastText = roasts.god[Math.floor(Math.random() * roasts.god.length)];
                } else if (sx >= 142 && total < 550) {
                    roastText = roasts.math_god_total_low[Math.floor(Math.random() * roasts.math_god_total_low.length)];
                } else if (yy >= 140 && total < 550) {
                    roastText = roasts.english_god_fail[Math.floor(Math.random() * roasts.english_god_fail.length)];
                } else if (sx < 65 && total > 400) {
                    roastText = roasts.math_fail[Math.floor(Math.random() * roasts.math_fail.length)];
                } else if (total >= 580 && total < 670) {
                    roastText = roasts.invisible_mid[Math.floor(Math.random() * roasts.invisible_mid.length)];
                } else if (total >= 480 && total < 580) {
                    roastText = roasts.struggling_mid[Math.floor(Math.random() * roasts.struggling_mid.length)];
                } else if (total >= 380 && total < 480) {
                    roastText = roasts.danger_zone[Math.floor(Math.random() * roasts.danger_zone.length)];
                } else if (total <= 320) {
                    roastText = roasts.low[Math.floor(Math.random() * roasts.low.length)];
                } else if (x_total > (yw + sx + yy) * 1.5) {
                    roastText = roasts.science_heavy[Math.floor(Math.random() * roasts.science_heavy.length)];
                } else if ((yw + yy) > (sx + x_total) * 1.5) {
                    roastText = roasts.arts_heavy[Math.floor(Math.random() * roasts.arts_heavy.length)];
                } else if (Math.abs(yw - sx) < 5 && Math.abs(sx - yy) < 5 && total < 450) {
                    roastText = roasts.perfect_balanced_low[Math.floor(Math.random() * roasts.perfect_balanced_low.length)];
                } else {
                    roastText = "è¿™æ˜¯ä¸€ä¸ªæ™®é€šåˆ°è¿AIéƒ½æ‡’å¾—ä¸ºä½ ç¼–æ®µå­çš„åˆ†æ•°ã€‚ä½ çš„æ¨¡æ‹Ÿè€ƒè¯•ï¼Œå¹³å‡¡å¾—å°±åƒé£Ÿå ‚é‡Œçš„ç™½èœï¼Œæ²¡æ¯’ï¼Œä½†ä¹Ÿæ²¡å‘³ã€‚";
                }

                roastText = applyRoastCityCopy(roastText);

                document.getElementById('roastFormArea').classList.add('hidden');
                const resArea = document.getElementById('roastResultArea');
                resArea.classList.remove('hidden');
                document.getElementById('roastText').innerText = roastText;

                // Sync text to hidden share card
                document.getElementById('shareRoastText').innerText = roastText;
                const labelEl = document.getElementById('shareRoastLabel');
                if (labelEl) {
                    const { name } = getRoastCityInfo();
                    labelEl.innerText = `2026${name}æ¨¡æ‹Ÿè€ƒè¯•Â·å®˜æ–¹å¯¹æ ‡`;
                }

                // Updated Button Logic: Humorous CTAs based on scores
                const helpBtn = document.getElementById('roastHelpBtn');
                const closeBtn = document.getElementById('roastCloseBtn');

                if (total >= 670) {
                    helpBtn.innerText = "ä½ å°±æ˜¯è€å¸ˆï¼Œå—æˆ‘ä¸€æ‹œ";
                    closeBtn.innerText = "ä¿¯ç°ä¼—ç”Ÿ";
                } else if (total <= 450 && total > 0) {
                    helpBtn.innerText = "è€å¸ˆä¹Ÿæ²¡æ‹›ï¼Œè‡ªç”Ÿè‡ªç­å§";
                    closeBtn.innerText = "å†è§æ­¤åœ°ç‹±(å¼€ç©ç¬‘)";
                } else {
                    helpBtn.innerText = "æ‰¾è€å¸ˆå‚æ­»æŠ¢æ•‘ä¸€ä¸‹";
                    closeBtn.innerText = "ä¸çœ‹äº†ï¼Œå¿ƒç¢äº†";
                }
            }

            async function captureRoast() {
                const btn = event ? event.currentTarget : null;
                const shareCard = document.getElementById('shareCard');
                const qrImg = document.getElementById('qrCode');
                const originalContent = btn ? btn.innerHTML : '';
                let prevStyles = null;

                if (!shareCard) {
                    alert('ç”Ÿæˆå›¾ç‰‡å¤±è´¥ï¼Œè¯·å°è¯•ç›´æ¥æˆªå›¾åˆ†äº«');
                    return;
                }

                if (btn) {
                    btn.innerHTML = '<span class="animate-spin inline-block">â³</span>';
                    btn.disabled = true;
                }

                try {
                    // Wait for images with timeout
                    await Promise.race([
                        new Promise(resolve => {
                            if (qrImg.complete) resolve();
                            else {
                                qrImg.onload = resolve;
                                qrImg.onerror = resolve;
                            }
                        }),
                        new Promise(resolve => setTimeout(resolve, 1500))
                    ]);

                    if (document.fonts && document.fonts.ready) {
                        await Promise.race([
                            document.fonts.ready,
                            new Promise(resolve => setTimeout(resolve, 800))
                        ]);
                    }

                    prevStyles = {
                        visibility: shareCard.style.visibility,
                        position: shareCard.style.position,
                        left: shareCard.style.left,
                        top: shareCard.style.top,
                        zIndex: shareCard.style.zIndex
                    };
                    shareCard.style.visibility = 'visible';
                    shareCard.style.position = 'fixed';
                    shareCard.style.left = '-9999px';
                    shareCard.style.top = '0';
                    shareCard.style.zIndex = '9999';

                    const canvas = await html2canvas(shareCard, {
                        backgroundColor: '#020617',
                        scale: 2,
                        useCORS: true,
                        allowTaint: false,
                        imageTimeout: 1500,
                        logging: false,
                        onclone: (clonedDoc) => {
                            // Ensure the cloned element is 'visible' for rendering
                            const el = clonedDoc.getElementById('shareCard');
                            if (el) {
                                el.style.visibility = 'visible';
                                el.style.position = 'fixed';
                                el.style.left = '0';
                                el.style.top = '0';
                                el.style.zIndex = '9999';
                            }
                        }
                    });

                    const link = document.createElement('a');
                    link.download = `ç§‹ç§‹åŒå­¦-AIæ¯’èˆŒæµ‹è¯„-${new Date().getTime()}.png`;
                    link.href = canvas.toDataURL('image/png');
                    link.click();
                } catch (err) {
                    console.error("Capture failed:", err);
                    alert("ç”Ÿæˆå›¾ç‰‡å¤±è´¥ï¼Œè¯·å°è¯•ç›´æ¥æˆªå›¾åˆ†äº«");
                } finally {
                    if (prevStyles) {
                        shareCard.style.visibility = prevStyles.visibility;
                        shareCard.style.position = prevStyles.position;
                        shareCard.style.left = prevStyles.left;
                        shareCard.style.top = prevStyles.top;
                        shareCard.style.zIndex = prevStyles.zIndex;
                    }
                    if (btn) {
                        btn.innerHTML = originalContent;
                        btn.disabled = false;
                    }
                }
            }

            // ==========================================
            // Existing logic (Previously updated)
            // ==========================================

            const CITY_META = {
                hefei: { name: 'åˆè‚¥å¸‚', examinees: 71000, strengthRank: 1 },
                fuyang: { name: 'é˜œé˜³å¸‚', examinees: 64035, strengthRank: 2 },
                anqing: { name: 'å®‰åº†å¸‚', examinees: 47726, strengthRank: 3 },
                lvan: { name: 'å…­å®‰å¸‚', examinees: 44477, strengthRank: 4 },
                bozhou: { name: 'äº³å·å¸‚', examinees: 40348, strengthRank: 5 },
                suzhou: { name: 'å®¿å·å¸‚', examinees: 40000, strengthRank: 6 },
                chuzhou: { name: 'æ»å·å¸‚', examinees: 25394, strengthRank: 7 },
                bengbu: { name: 'èšŒåŸ å¸‚', examinees: 26702, strengthRank: 8 },
                tongling: { name: 'é“œé™µå¸‚', examinees: 14874, strengthRank: 9 },
                suzhou: { name: 'å®¿å·å¸‚', examinees: 40000, strengthRank: 10 },
                xuancheng: { name: 'å®£åŸå¸‚', examinees: 14486, strengthRank: 11 },
                maanshan: { name: 'é©¬éå±±å¸‚', examinees: 14033, strengthRank: 12 },
                huainan: { name: 'æ·®å—å¸‚', examinees: 33000, strengthRank: 13 },
                chizhou: { name: 'æ± å·å¸‚', examinees: 11400, strengthRank: 14 },
                huangshan: { name: 'é»„å±±å¸‚', examinees: 7000, strengthRank: 15 },
                huaibei: { name: 'æ·®åŒ—å¸‚', examinees: 15352, strengthRank: 16 }
            };

            const citySelectEl = document.getElementById('city');
            const cityBtnEl = document.getElementById('cityBtn');
            const cityBtnTextEl = document.getElementById('cityBtnText');
            const cityMenuEl = document.getElementById('cityMenu');

            function setCityUI(cityKey) {
                if (citySelectEl && cityKey) citySelectEl.value = cityKey;
                const nameFromMeta = CITY_META && CITY_META[cityKey] && CITY_META[cityKey].name ? CITY_META[cityKey].name : '';
                const btn = cityKey ? document.querySelector(`.cityOption[data-city="${cityKey}"]`) : null;
                const nameFromBtn = btn ? String(btn.innerText || '').trim() : '';
                const name = nameFromMeta || nameFromBtn || 'è¯·é€‰æ‹©';
                if (cityBtnTextEl) cityBtnTextEl.innerText = name;
            }

            function closeCityMenu() {
                if (!cityMenuEl) return;
                cityMenuEl.classList.add('hidden');
            }

            function openCityMenu() {
                if (!cityMenuEl) return;
                cityMenuEl.classList.remove('hidden');
            }

            function toggleCityMenu() {
                if (!cityMenuEl) return;
                if (cityMenuEl.classList.contains('hidden')) openCityMenu();
                else closeCityMenu();
            }

            if (cityBtnEl) {
                cityBtnEl.addEventListener('click', (e) => {
                    e.preventDefault();
                    toggleCityMenu();
                });
            }

            document.querySelectorAll('.cityOption').forEach((btn) => {
                btn.addEventListener('click', () => {
                    const key = btn.dataset && btn.dataset.city ? btn.dataset.city : '';
                    if (key) setCityUI(key);
                    closeCityMenu();
                });
            });

            document.addEventListener('click', (e) => {
                if (!cityMenuEl || !cityBtnEl) return;
                const t = e.target;
                if (cityMenuEl.contains(t) || cityBtnEl.contains(t)) return;
                closeCityMenu();
            });

            document.addEventListener('keydown', (e) => {
                if (e.key === 'Escape') closeCityMenu();
            });

            if (citySelectEl) {
                setCityUI(citySelectEl.value || 'hefei');
                citySelectEl.addEventListener('change', () => setCityUI(citySelectEl.value));
            }

            function computeDaysToGaokao() {
                const today = new Date();
                const thisYearTarget = new Date(today.getFullYear(), 5, 7);
                const target = today > thisYearTarget ? new Date(today.getFullYear() + 1, 5, 7) : thisYearTarget;
                const ms = target.getTime() - today.getTime();
                const days = Math.max(0, Math.ceil(ms / 86400000));
                return clamp(days, 0, 500);
            }

            let lastCalcContext = null;
            const provRankMaxCache = {};

            function clamp(num, min, max) {
                if (num < min) return min;
                if (num > max) return max;
                return num;
            }

            function getCityFactor(city) {
                const base = CITY_META.hefei && CITY_META.hefei.examinees ? CITY_META.hefei.examinees : 47000;
                const n = CITY_META[city] && CITY_META[city].examinees ? CITY_META[city].examinees : base;
                const raw = base / n;
                return clamp(raw, 0.6, 3.5);
            }

            function getStrengthAdjust(city) {
                const r = CITY_META[city] && typeof CITY_META[city].strengthRank === 'number' ? CITY_META[city].strengthRank : 5;
                const rank = clamp(r, 1, 9);
                const t = (rank - 1) / 8;
                const span = 0.08;
                const raw = 1 + ((t - 0.5) * span);
                return clamp(raw, 0.96, 1.04);
            }

            function getRankBucket(subject, rank) {
                if (subject === 'physics') {
                    if (rank <= 100) return 'p_100';
                    if (rank <= 500) return 'p_500';
                    if (rank <= 2000) return 'p_2000';
                    if (rank <= 5000) return 'p_5000';
                    return 'p_rest';
                }
                if (rank <= 100) return 'h_100';
                if (rank <= 1000) return 'h_1000';
                return 'h_rest';
            }

            function getBaseCoefficient(subject, rank) {
                if (subject === 'physics') {
                    if (rank <= 100) return 1.5;
                    if (rank <= 500) return 1.8;
                    if (rank <= 2000) return 2.1;
                    if (rank <= 5000) return 2.4;
                    return 2.6;
                }
                if (rank <= 100) return 1.4;
                if (rank <= 1000) return 2.0;
                return 2.5;
            }

            function getDifficultyAdjust(difficulty) {
                if (difficulty === 'easy') return 1.08;
                if (difficulty === 'hard') return 0.92;
                return 1.0;
            }

            function getProvRankMax(subject) {
                if (provRankMaxCache[subject]) return provRankMaxCache[subject];
                if (typeof realData2024 === 'undefined' || !realData2024[subject] || !realData2024[subject].length) {
                    provRankMaxCache[subject] = 200000;
                    return provRankMaxCache[subject];
                }
                let maxR = 0;
                realData2024[subject].forEach(item => {
                    if (item && typeof item.r === 'number' && item.r > maxR) maxR = item.r;
                });
                provRankMaxCache[subject] = maxR || 200000;
                return provRankMaxCache[subject];
            }

            function getCalibrationKey(subject, city, bucket) {
                return `jl_rank_calib_v1:${subject}:${city}:${bucket}`;
            }

            function loadCalibrationFactor(subject, city, bucket) {
                const key = getCalibrationKey(subject, city, bucket);
                const raw = localStorage.getItem(key);
                const val = parseFloat(raw);
                if (!Number.isFinite(val) || val <= 0) return 1.0;
                return val;
            }

            function saveCalibrationFactor(subject, city, bucket, factor) {
                const key = getCalibrationKey(subject, city, bucket);
                localStorage.setItem(key, String(factor));
            }

            function calculateEstProvRank(cityRank, subject, difficulty = 'normal', city = 'hefei') {
                const base = getBaseCoefficient(subject, cityRank);
                const diff = getDifficultyAdjust(difficulty);
                const cityFactor = getCityFactor(city);
                const strength = getStrengthAdjust(city);
                const raw = Math.floor(cityRank * base * cityFactor * strength * diff);
                const maxRank = getProvRankMax(subject);
                return clamp(raw, 1, maxRank);
            }

            function computeEstScoreFromRank(estProvRank, subject) {
                let estScore = "---";
                if (typeof realData2024 === 'undefined' || !realData2024 || !realData2024[subject] || !realData2024[subject].length) {
                    return estScore;
                }
                const data = realData2024[subject];
                let lower = null, upper = null;
                for (let i = 0; i < data.length; i++) {
                    if (data[i].r <= estProvRank) {
                        if (!lower || data[i].r > lower.r) lower = data[i];
                    } else {
                        if (!upper || data[i].r < upper.r) upper = data[i];
                    }
                }
                if (lower && upper) {
                    const ratio = (estProvRank - lower.r) / (upper.r - lower.r);
                    estScore = Math.round(lower.s - (lower.s - upper.s) * ratio);
                } else if (lower) estScore = lower.s;
                else if (upper) estScore = upper.s;
                return estScore;
            }

            let lastReportShareData = null;

            function getSubjectLabel(subject) {
                if (subject === 'physics') return 'ç‰©ç†ç±»';
                if (subject === 'history') return 'å†å²ç±»';
                return 'ç»¼åˆ';
            }

            function simulateComputeTimeMs(estProvRank) {
                const r = Number.isFinite(estProvRank) ? estProvRank : 10000;
                const scale = r > 30000 ? 1.45 : r > 15000 ? 1.25 : r > 5000 ? 1.1 : 1.0;
                const base = 8 + Math.floor(Math.random() * 13);
                return clamp(Math.round(base * scale), 6, 36);
            }

            function getRankRange(items) {
                if (!Array.isArray(items) || items.length === 0) return null;
                let min = Infinity;
                let max = -Infinity;
                for (const it of items) {
                    if (!it || typeof it.r !== 'number') continue;
                    if (it.r < min) min = it.r;
                    if (it.r > max) max = it.r;
                }
                if (!Number.isFinite(min) || !Number.isFinite(max)) return null;
                return { min, max };
            }

            function formatRankRange(range) {
                if (!range) return 'æš‚æ— ';
                return `${range.min.toLocaleString()}~${range.max.toLocaleString()}ä½`;
            }

            function formatTopLines(items, maxLines = 2) {
                if (!Array.isArray(items) || items.length === 0) return 'æš‚æ— åŒ¹é…';
                const lines = [];
                for (const it of items) {
                    if (!it || !it.n || !it.m) continue;
                    lines.push(`${it.n} Â· ${it.m}`);
                    if (lines.length >= maxLines) break;
                }
                return lines.length ? lines.join('<br>') : 'æš‚æ— åŒ¹é…';
            }

            function syncReportShareCard(data) {
                const card = document.getElementById('shareReportCard');
                if (!card || !data) return;

                const rankEl = document.getElementById('shareReportRank');
                const scoreEl = document.getElementById('shareReportScore');
                const cityEl = document.getElementById('shareReportCity');
                const subjectEl = document.getElementById('shareReportSubject');
                const chongRangeEl = document.getElementById('shareReportChongRange');
                const wenRangeEl = document.getElementById('shareReportWenRange');
                const baoRangeEl = document.getElementById('shareReportBaoRange');
                const chongTopEl = document.getElementById('shareReportChongTop');
                const wenTopEl = document.getElementById('shareReportWenTop');
                const baoTopEl = document.getElementById('shareReportBaoTop');

                if (rankEl) rankEl.innerText = String(data.estProvRank).replace(/\B(?=(\d{3})+(?!\d))/g, ',');
                if (scoreEl) scoreEl.innerText = data.estScore === '---' ? '---' : String(data.estScore);
                if (cityEl) cityEl.innerText = data.cityName || '---';
                if (subjectEl) subjectEl.innerText = data.subjectLabel || '---';
                const ranges = data.ranges || {};
                const top = data.top || {};
                if (chongRangeEl) chongRangeEl.innerText = formatRankRange(ranges.chong || null);
                if (wenRangeEl) wenRangeEl.innerText = formatRankRange(ranges.wen || null);
                if (baoRangeEl) baoRangeEl.innerText = formatRankRange(ranges.bao || null);
                if (chongTopEl) chongTopEl.innerHTML = formatTopLines(top.chong || [], 2);
                if (wenTopEl) wenTopEl.innerHTML = formatTopLines(top.wen || [], 2);
                if (baoTopEl) baoTopEl.innerHTML = formatTopLines(top.bao || [], 2);
            }

            function setShareActionStatus(text) {
                const el = document.getElementById('shareActionStatus');
                if (!el) return;
                el.innerText = text || '';
                window.clearTimeout(setShareActionStatus._t);
                if (text) {
                    setShareActionStatus._t = window.setTimeout(() => {
                        el.innerText = '';
                    }, 2200);
                }
            }

            async function captureReport() {
                const btn = event ? event.currentTarget : null;
                const shareCard = document.getElementById('shareReportCard');
                const qrImg = document.getElementById('reportQrCode');
                const originalContent = btn ? btn.innerHTML : '';
                let prevStyles = null;

                if (!shareCard) {
                    alert('ç”Ÿæˆå›¾ç‰‡å¤±è´¥ï¼Œè¯·å°è¯•ç›´æ¥æˆªå›¾åˆ†äº«');
                    return;
                }

                if (btn) {
                    btn.innerHTML = '<span class="animate-spin inline-block">â³</span>';
                    btn.disabled = true;
                }

                try {
                    syncReportShareCard(lastReportShareData);

                    await Promise.race([
                        new Promise(resolve => {
                            if (!qrImg) return resolve();
                            if (qrImg.complete) resolve();
                            else {
                                qrImg.onload = resolve;
                                qrImg.onerror = resolve;
                            }
                        }),
                        new Promise(resolve => setTimeout(resolve, 1500))
                    ]);

                    if (document.fonts && document.fonts.ready) {
                        await Promise.race([
                            document.fonts.ready,
                            new Promise(resolve => setTimeout(resolve, 800))
                        ]);
                    }

                    prevStyles = {
                        visibility: shareCard.style.visibility,
                        position: shareCard.style.position,
                        left: shareCard.style.left,
                        top: shareCard.style.top,
                        zIndex: shareCard.style.zIndex
                    };
                    shareCard.style.visibility = 'visible';
                    shareCard.style.position = 'fixed';
                    shareCard.style.left = '-9999px';
                    shareCard.style.top = '0';
                    shareCard.style.zIndex = '9999';

                    const canvas = await html2canvas(shareCard, {
                        backgroundColor: '#020617',
                        scale: 2,
                        useCORS: true,
                        allowTaint: false,
                        imageTimeout: 1500,
                        logging: false,
                        onclone: (clonedDoc) => {
                            const el = clonedDoc.getElementById('shareReportCard');
                            if (el) {
                                el.style.visibility = 'visible';
                                el.style.position = 'fixed';
                                el.style.left = '0';
                                el.style.top = '0';
                                el.style.zIndex = '9999';
                            }
                        }
                    });

                    const link = document.createElement('a');
                    link.download = `ç§‹ç§‹åŒå­¦-é«˜è€ƒæ¨¡æ‹ŸæŠ¥å‘Š-${new Date().getTime()}.png`;
                    link.href = canvas.toDataURL('image/png');
                    link.click();
                    setShareActionStatus('âœ“ æµ·æŠ¥å·²ç”Ÿæˆ');
                } catch (err) {
                    console.error("Capture failed:", err);
                    alert("ç”Ÿæˆå›¾ç‰‡å¤±è´¥ï¼Œè¯·å°è¯•ç›´æ¥æˆªå›¾åˆ†äº«");
                } finally {
                    if (prevStyles) {
                        shareCard.style.visibility = prevStyles.visibility;
                        shareCard.style.position = prevStyles.position;
                        shareCard.style.left = prevStyles.left;
                        shareCard.style.top = prevStyles.top;
                        shareCard.style.zIndex = prevStyles.zIndex;
                    }
                    if (btn) {
                        btn.innerHTML = originalContent;
                        btn.disabled = false;
                    }
                }
            }

            function updateOverlayResults(ctx) {
                const estProvRank = calculateEstProvRank(ctx.rank, ctx.subject, ctx.difficulty, ctx.city);
                const estScore = computeEstScoreFromRank(estProvRank, ctx.subject);
                document.getElementById('estProvRank').innerText = estProvRank.toLocaleString();
                document.getElementById('estScore').innerText = estScore;
                const cityName = (CITY_META[ctx.city] && CITY_META[ctx.city].name) ? CITY_META[ctx.city].name : '---';
                document.getElementById('estCityName').innerText = cityName;

                const daysToGaokao = (ctx && typeof ctx.daysToGaokao === 'number') ? ctx.daysToGaokao : computeDaysToGaokao();
                const recs = getRecommendations(estProvRank, ctx.subject, daysToGaokao);
                document.getElementById('listChong').innerHTML = recs.chong.length ? recs.chong.map(renderRow).join('') : '<div class="text-[10px] text-slate-400 py-4 text-center">æš‚æ— åˆé€‚å†²åˆºç›®æ ‡</div>';
                document.getElementById('listWen').innerHTML = recs.wen.length ? recs.wen.map(renderRow).join('') : '<div class="text-[10px] text-slate-400 py-4 text-center">æ­£åœ¨åŒæ­¥æœ€æ–°åŒ¹é…æ•°æ®</div>';
                document.getElementById('listBao').innerHTML = recs.bao.length ? recs.bao.map(renderRow).join('') : '<div class="text-[10px] text-slate-400 py-4 text-center">å·²å¤„äºå®‰å…¨çº¿ï¼Œæ— éœ€å…œåº•</div>';
                const costEl = document.getElementById('calcCost');
                if (costEl) costEl.innerText = `${simulateComputeTimeMs(estProvRank)}ms`;

                lastReportShareData = {
                    subjectLabel: getSubjectLabel(ctx.subject),
                    cityName,
                    estProvRank,
                    estScore,
                    ranges: {
                        chong: getRankRange(recs.chong),
                        wen: getRankRange(recs.wen),
                        bao: getRankRange(recs.bao)
                    },
                    top: {
                        chong: recs.chong || [],
                        wen: recs.wen || [],
                        bao: recs.bao || []
                    }
                };
                syncReportShareCard(lastReportShareData);
                return estProvRank;
            }

            function getRecommendations(estRank, subject, daysToGaokao = null) {
                if (typeof realData2024 === 'undefined' || !realData2024[subject]) {
                    return { chong: [], wen: [], bao: [] };
                }

                const data = realData2024[subject];
                const recs = { chong: [], wen: [], bao: [] };

                let rangeScale = 1.0;
                if (estRank > 30000) rangeScale = 4.0;
                else if (estRank > 15000) rangeScale = 2.5;
                else if (estRank > 5000) rangeScale = 1.5;

                const safeDays = Number.isFinite(daysToGaokao) ? clamp(daysToGaokao, 0, 500) : null;
                const ambition = safeDays == null ? 1.0 : clamp(safeDays / 100, 0, 3);
                const timeScale = safeDays == null
                    ? 1.0
                    : (safeDays <= 30 ? 0.75 : safeDays <= 100 ? 0.9 : safeDays <= 200 ? 1.05 : 1.2);
                const reach = safeDays == null ? 1.0 : clamp(1 + ambition * 0.5, 1, 2.5);
                const chongNearFactor = safeDays == null ? 1.0 : clamp(0.6 + ambition * 0.2, 0.6, 1.2);

                const chongMin = estRank - (1200 * rangeScale * timeScale * reach);
                const chongMax = estRank - (100 * rangeScale * timeScale * chongNearFactor);
                const wenMin = estRank - (100 * rangeScale * timeScale);
                const wenMax = estRank + (1200 * rangeScale * timeScale);
                const baoMin = estRank + (1200 * rangeScale * timeScale);
                const baoMax = estRank + (5000 * rangeScale * timeScale);

                data.forEach(item => {
                    const r = item.r;
                    if (r >= chongMin && r < chongMax) recs.chong.push(item);
                    if (r >= wenMin && r <= wenMax) recs.wen.push(item);
                    if (r > baoMin && r <= baoMax) recs.bao.push(item);
                });

                recs.chong.sort((a, b) => b.r - a.r);
                recs.wen.sort((a, b) => Math.abs(a.r - estRank) - Math.abs(b.r - estRank));
                recs.bao.sort((a, b) => a.r - b.r);

                function pickTop(items, count) {
                    const picked = [];
                    const seen = new Set();
                    const schoolCount = {};
                    for (const item of items) {
                        if (!item || !item.n || !item.m) continue;
                        const key = `${item.n}__${item.m}`;
                        if (seen.has(key)) continue;
                        const sc = schoolCount[item.n] || 0;
                        if (sc >= 2) continue;
                        picked.push(item);
                        seen.add(key);
                        schoolCount[item.n] = sc + 1;
                        if (picked.length >= count) break;
                    }
                    return picked;
                }

                return {
                    chong: pickTop(recs.chong, 5),
                    wen: pickTop(recs.wen, 6),
                    bao: pickTop(recs.bao, 5)
                };
            }

            function renderRow(item) {
                let tagsHtml = "";
                item.t.forEach(t => {
                    if (t === '985') tagsHtml += `<span class="tag tag-985 mr-1">985</span>`;
                    else if (t === '211') tagsHtml += `<span class="tag tag-211 mr-1">211</span>`;
                    else if (t === 'çœå†…') tagsHtml += `<span class="tag tag-local">çœå†…</span>`;
                });

                return `
            <div class="group flex items-center justify-between p-3 rounded-xl hover:bg-slate-50 transition-all border-b border-slate-50 last:border-none">
                <div class="flex flex-col flex-1 min-w-0 pr-4">
                    <div class="flex items-center mb-1 overflow-hidden">
                        <span class="font-bold text-slate-800 text-xs truncate mr-2">${item.n}</span>
                        <div class="flex flex-shrink-0">${tagsHtml}</div>
                    </div>
                    <div class="flex items-center space-x-2">
                        <span class="text-[9px] text-slate-400 font-medium">${item.l}</span>
                        <div class="px-2 py-0.5 rounded bg-blue-50 text-[9px] text-blue-600 font-bold truncate">${item.m}</div>
                    </div>
                </div>
                <div class="text-right flex-shrink-0">
                    <div class="text-xs font-black text-slate-700 leading-tight">${item.r}<span class="text-[8px] font-bold ml-0.5">ä½</span></div>
                    <div class="text-[9px] text-slate-400 font-medium">${item.s}åˆ†</div>
                </div>
            </div>
            `;
            }

            const overlay = document.getElementById('resultOverlay');
            const feedbackHighBtn = document.getElementById('feedbackHighBtn');
            const feedbackLowBtn = document.getElementById('feedbackLowBtn');
            const feedbackOkBtn = document.getElementById('feedbackOkBtn');
            const feedbackStatusEl = document.getElementById('feedbackStatus');

            function getOrCreateAnonId() {
                const key = 'jl_anon_id_v1';
                const existing = localStorage.getItem(key);
                if (existing && existing.length >= 8) return existing;
                let id = '';
                if (window.crypto && typeof window.crypto.randomUUID === 'function') id = window.crypto.randomUUID();
                else id = `${Date.now()}_${Math.random().toString(16).slice(2)}`;
                localStorage.setItem(key, id);
                return id;
            }

            async function sendFeedbackEvent(feedbackType) {
                if (!lastCalcContext) return;
                const estProvRank = calculateEstProvRank(lastCalcContext.rank, lastCalcContext.subject, lastCalcContext.difficulty, lastCalcContext.city);
                const estScore = computeEstScoreFromRank(estProvRank, lastCalcContext.subject);

                const payload = {
                    anonId: getOrCreateAnonId(),
                    feedbackType,
                    subject: lastCalcContext.subject,
                    city: lastCalcContext.city,
                    rank: lastCalcContext.rank,
                    score: lastCalcContext.score,
                    difficulty: lastCalcContext.difficulty,
                    estProvRank,
                    estScore: typeof estScore === 'number' ? estScore : null,
                    page: window.location.href,
                    ts: Date.now()
                };

                try {
                    if (navigator.sendBeacon) {
                        const blob = new Blob([JSON.stringify(payload)], { type: 'application/json' });
                        navigator.sendBeacon('feedback.php', blob);
                        return;
                    }
                    await fetch('feedback.php', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(payload)
                    });
                } catch (_) {
                }
            }

            function applyFeedback(type) {
                if (!lastCalcContext) return;
                sendFeedbackEvent(type);
                if (feedbackStatusEl) {
                    if (type === 'high') feedbackStatusEl.innerText = 'å·²è®°å½•ï¼šä½ è®¤ä¸ºæœ¬æ¬¡é¢„ä¼°åé«˜ï¼ˆä»…ç”¨äºæ•°æ®é‡‡é›†ï¼‰';
                    else if (type === 'low') feedbackStatusEl.innerText = 'å·²è®°å½•ï¼šä½ è®¤ä¸ºæœ¬æ¬¡é¢„ä¼°åä½ï¼ˆä»…ç”¨äºæ•°æ®é‡‡é›†ï¼‰';
                    else feedbackStatusEl.innerText = 'å·²è®°å½•ï¼šä½ è®¤ä¸ºæœ¬æ¬¡é¢„ä¼°ä¸é”™ï¼ˆä»…ç”¨äºæ•°æ®é‡‡é›†ï¼‰';
                    window.clearTimeout(applyFeedback._t);
                    applyFeedback._t = window.setTimeout(() => {
                        feedbackStatusEl.innerText = '';
                    }, 2200);
                }
            }

            if (feedbackHighBtn) feedbackHighBtn.addEventListener('click', () => applyFeedback('high'));
            if (feedbackLowBtn) feedbackLowBtn.addEventListener('click', () => applyFeedback('low'));
            if (feedbackOkBtn) feedbackOkBtn.addEventListener('click', () => applyFeedback('ok'));

            document.getElementById('predictForm').addEventListener('submit', function (e) {
                e.preventDefault();

                if (typeof realData2024 === 'undefined') {
                    alert('ç³»ç»Ÿæ•°æ®åŠ è½½ä¸­ï¼Œè¯·ç¨å...');
                    return;
                }

                const btn = document.getElementById('submitBtn');
                const btnText = document.getElementById('btnText');
                const loadingDots = document.getElementById('loadingDots');

                // è§†è§‰åŠ¨æ•ˆï¼šæ¨¡æ‹Ÿè®¡ç®—è¿‡ç¨‹
                btn.disabled = true;
                btnText.innerText = 'æ­£åœ¨å¯¹æ ‡æ¨¡æ‹Ÿè€ƒè¯•å¤§æ•°æ®';
                loadingDots.classList.remove('hidden');

                const mockLinesByCity = {
                    hefei: {
                        physics: [
                            { score: 598.5, name: 'é«˜ä¼˜æœ‰æ•ˆåˆ†', advise: 'å†²å‡»é¡¶å°–985ï¼Œæ³¨æ„ç»†èŠ‚' },
                            { score: 520, name: 'ä¸€æœ¬æœ‰æ•ˆåˆ†', advise: 'ç¨³å®ˆä¸€æœ¬ï¼Œçªç ´211' },
                            { score: 467, name: 'ç‰¹æ§æœ‰æ•ˆåˆ†', advise: 'è¿‡ç‰¹æ§çº¿ï¼ŒåŠ å¼ºä¸»å¹²çŸ¥è¯†' },
                            { score: 326.5, name: 'æœ¬ç§‘æœ‰æ•ˆåˆ†', advise: 'è¿‡æœ¬ç§‘çº¿ï¼Œç”±äºæ•°å­¦/ç‰©ç†è¾ƒéš¾ï¼Œè¯·ç¨³ä½å¿ƒæ€' }
                        ],
                        history: [
                            { score: 587.5, name: 'é«˜ä¼˜æœ‰æ•ˆåˆ†', advise: 'å‘æŒ¥ç¨³å®šï¼Œå†²å‡»åŒä¸€æµ' },
                            { score: 517.5, name: 'ä¸€æœ¬æœ‰æ•ˆåˆ†', advise: 'ç¨³è¿‡ä¸€æœ¬ç·šï¼Œæå‡ç»¼åˆå®åŠ›' },
                            { score: 458.5, name: 'ç‰¹æ§æœ‰æ•ˆåˆ†', advise: 'è¿‡ç‰¹æ§çº¿ï¼Œé‡ç‚¹æå‡æ–‡ç»¼' },
                            { score: 312.5, name: 'æœ¬ç§‘æœ‰æ•ˆåˆ†', advise: 'è¿‡æœ¬ç§‘çº¿ï¼Œç»§ç»­å¤¯å®åŸºç¡€çŸ¥è¯†' }
                        ]
                    }
                };

                setTimeout(() => {
                    const subject = document.querySelector('input[name="subject"]:checked').value;
                    const city = document.getElementById('city').value;
                    const rank = parseInt(document.getElementById('rank').value);
                    const score = parseFloat(document.getElementById('score').value);
                    const difficulty = document.querySelector('input[name="difficulty"]:checked').value;
                    const daysToGaokao = computeDaysToGaokao();

                    if (!rank || rank < 1 || rank > 50000) {
                        resetBtn();
                        return;
                    }

                    const cityName = (typeof CITY_META !== 'undefined' && CITY_META[city] && CITY_META[city].name) ? CITY_META[city].name : 'æœ¬å¸‚';
                    const mockHeaderEl = document.getElementById('mockHeader');
                    const lines = mockLinesByCity[city] && mockLinesByCity[city][subject] ? mockLinesByCity[city][subject] : null;

                    if (!lines || !lines.length) {
                        if (mockHeaderEl) mockHeaderEl.innerText = `2026${cityName}æ¨¡æ‹Ÿè€ƒè¯•Â·å®˜æ–¹å¯¹æ ‡æ°´å¹³ï¼ˆæš‚æœªå…¬å¸ƒï¼‰`;
                        document.getElementById('mockLevelName').innerText = 'æš‚æœªå…¬å¸ƒ';
                        document.getElementById('mockLevelAdvise').innerText = `${cityName}å®˜æ–¹æ¨¡æ‹Ÿè€ƒè¯•åˆ†æ•°çº¿æš‚æœªå…¬å¸ƒï¼Œæ•°æ®åº“å°šæœªæ›´æ–°ï¼›å…¬å¸ƒåä¼šç¬¬ä¸€æ—¶é—´æ›´æ–°ï¼Œç»“æœæ›´å‡†ç¡®ï¼`;
                    } else {
                        if (mockHeaderEl) mockHeaderEl.innerText = `2026${cityName}æ¨¡æ‹Ÿè€ƒè¯•Â·å®˜æ–¹å¯¹æ ‡æ°´å¹³`;
                        let levelName = "æœªè¾¾æœ¬ç§‘æœ‰æ•ˆåˆ†";
                        let levelAdvise = "ä½äºæœ¬ç§‘æœ‰æ•ˆåˆ†ï¼šå…ˆç¨³ä½åŸºç¡€åˆ†ï¼Œä¸»æ”»å¸¸è§„é¢˜å‹";
                        for (const line of lines) {
                            if (score >= line.score) {
                                levelName = line.name;
                                levelAdvise = line.advise;
                                break;
                            }
                        }
                        document.getElementById('mockLevelName').innerText = levelName;
                        document.getElementById('mockLevelAdvise').innerText = levelAdvise;
                    }

                    lastCalcContext = { subject, city, rank, score, difficulty, daysToGaokao };
                    updateOverlayResults(lastCalcContext);
                    sendFeedbackEvent('predict');

                    // Show Popup
                    overlay.style.display = 'block';
                    document.body.style.overflow = 'hidden';
                    resetBtn();
                }, 1200);

                function resetBtn() {
                    btn.disabled = false;
                    btnText.innerText = 'ç«‹å³ç”Ÿæˆå¤šç»´åˆ†ææŠ¥è¡¨';
                    loadingDots.classList.add('hidden');
                }
            });

            function closeOverlay() {
                overlay.style.display = 'none';
                document.body.style.overflow = 'auto';
            }

            function copyWechat() {
                const wechatId = 'A15655736069';
                if (navigator.clipboard) {
                    navigator.clipboard.writeText(wechatId).then(() => {
                        const textEl = document.getElementById('wechatText');
                        textEl.textContent = 'âœ“ å·²å¤åˆ¶ï¼Œå»å¾®ä¿¡ç²˜è´´æœç´¢';
                        setTimeout(() => { textEl.textContent = 'æ·»åŠ å¾®ä¿¡ï¼šé¢„çº¦è¯•å·åˆ†æ'; }, 3000);
                    });
                } else {
                    alert('å¾®ä¿¡å·ï¼šA15655736069');
                }
            }

            function roastCopyWechat() {
                const btnText = document.getElementById('roastHelpBtn').innerText;
                const wechatId = 'A15655736069';
                if (navigator.clipboard) {
                    navigator.clipboard.writeText(wechatId).then(() => {
                        let title = "å¤åˆ¶æˆåŠŸ";
                        let msg = "å¾®ä¿¡å·å·²å¤åˆ¶ï¼æ‰“å¼€å¾®ä¿¡ï¼Œç²˜è´´åˆ°æœç´¢æ¡†å³å¯æ·»åŠ ï¼ˆå¾®ä¿¡å·ï¼š" + wechatId + "ï¼‰ã€‚";

                        if (btnText.includes("è‡ªç”Ÿè‡ªç­")) {
                            title = "åˆ«èµ°ï¼è¿˜æœ‰åè½¬";
                            msg = "å…¶å®ä½ è¿˜æœ‰æ•‘ï¼åˆšæ‰é‚£æ˜¯AIä¸ºäº†æ¿€å‘ä½ çš„æ–—å¿—åœ¨æ¼”æˆã€‚å¾®ä¿¡å·å·²å¤åˆ¶ï¼Œæ‰“å¼€å¾®ä¿¡ç²˜è´´æœç´¢ï¼ŒåŠ æˆ‘åå’±ä»¬æŠŠå·é¢å¤±åˆ†ä¸€é¡¹é¡¹å¤ç›˜æ¸…æ¥šã€‚";
                        } else if (btnText.includes("å—æˆ‘ä¸€æ‹œ")) {
                            title = "å‘å­¦éœ¸è‡´æ•¬";
                            msg = "å¾®ä¿¡å·å·²å¤åˆ¶ï¼æ‰“å¼€å¾®ä¿¡ç²˜è´´æœç´¢å³å¯æ·»åŠ ã€‚æœŸå¾…äº¤æµå­¦ä¹ æ–¹æ³•ä¸å†²åˆºè§„åˆ’ã€‚";
                        }

                        showRoastAlert(title, msg);
                    });
                } else {
                    showRoastAlert("å¾®ä¿¡å·", "è¯·æ‰‹åŠ¨å¤åˆ¶ï¼šA15655736069ï¼Œç„¶åå»å¾®ä¿¡ç²˜è´´æœç´¢æ·»åŠ ã€‚");
                }
            }

            function showRoastAlert(title, content) {
                document.getElementById('roastAlertTitle').innerText = title;
                document.getElementById('roastAlertContent').innerText = content;
                const modal = document.getElementById('roastAlertModal');
                modal.classList.remove('hidden');
                modal.classList.add('flex');
            }

            function closeRoastAlert() {
                document.getElementById('roastAlertModal').classList.add('hidden');
                document.getElementById('roastAlertModal').classList.remove('flex');
            }

            function openTemplate() {
                document.getElementById('templateOverlay').classList.remove('hidden');
                document.getElementById('templateOverlay').classList.add('flex');
            }

            function closeTemplate() {
                document.getElementById('templateOverlay').classList.add('hidden');
                document.getElementById('templateOverlay').classList.remove('flex');
            }
        </script>
</body>

</html>
