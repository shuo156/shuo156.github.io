<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>å­¦æƒ…åˆ†ææŠ¥å‘Š</title>
    <style>
        :root {
            --primary: #448aff; /* æ™ºå­¦è“ */
            --primary-dark: #2962ff;
            --bg: #f5f7fa;
            --card-bg: #ffffff;
            --text-main: #333333;
            --text-sub: #999999;
            --border: #e0e0e0;
            --danger: #ff5252;
            --success: #4caf50;
            --shadow: 0 2px 10px rgba(0,0,0,0.05);
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body { margin: 0; font-family: -apple-system, BlinkMacSystemFont, "PingFang SC", "Helvetica Neue", Arial, sans-serif; background: var(--bg); color: var(--text-main); padding-top: 100px; padding-bottom: 30px; }

        /* --- é¡¶éƒ¨å›ºå®šå¯¼èˆª --- */
        .app-header {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            background: var(--primary);
            color: #fff;
            z-index: 100;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .header-top {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 50px;
            font-size: 18px;
            font-weight: 600;
        }

        /* æ¨ªå‘æ»šåŠ¨å¯¼èˆªæ¡ */
        .nav-scroller {
            overflow-x: auto;
            white-space: nowrap;
            background: #fff;
            padding: 0 10px;
            border-bottom: 1px solid var(--border);
            scrollbar-width: none; /* Firefoxéšè—æ»šåŠ¨æ¡ */
        }
        .nav-scroller::-webkit-scrollbar { display: none; } /* Chromeéšè—æ»šåŠ¨æ¡ */

        .nav-item {
            display: inline-block;
            padding: 12px 15px;
            font-size: 15px;
            color: var(--text-sub);
            position: relative;
            cursor: pointer;
            transition: color 0.3s;
        }

        .nav-item.active {
            color: var(--primary);
            font-weight: 600;
        }

        .nav-item.active::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 15px;
            right: 15px;
            height: 3px;
            background: var(--primary);
            border-radius: 3px 3px 0 0;
        }

        /* --- å†…å®¹åŒºåŸŸ --- */
        .tab-content {
            display: none;
            padding: 15px;
            max-width: 600px;
            margin: 0 auto;
            animation: fadeIn 0.3s ease;
        }
        .tab-content.active { display: block; }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* --- å¡ç‰‡é€šç”¨æ ·å¼ --- */
        .card {
            background: var(--card-bg);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 15px;
            box-shadow: var(--shadow);
        }

        .card-title {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .card-title::before {
            content: '';
            display: inline-block;
            width: 4px;
            height: 16px;
            background: var(--primary);
            margin-right: 8px;
            border-radius: 2px;
            vertical-align: middle;
        }

        /* --- ä»ªè¡¨ç›˜åœ†ç¯ --- */
        .score-dashboard {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px 0;
        }

        .ring-container {
            position: relative;
            width: 160px;
            height: 160px;
        }

        .progress-ring { transform: rotate(-90deg); }
        .progress-ring__circle {
            transition: stroke-dashoffset 0.6s ease;
            transform-origin: 50% 50%;
        }

        .score-overlay {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
        }

        .big-score {
            font-size: 42px;
            font-weight: bold;
            color: var(--primary);
            line-height: 1;
        }

        .total-label {
            font-size: 12px;
            color: var(--text-sub);
            margin-top: 5px;
        }

        /* --- æ’åæ•°æ®æ ¼ --- */
        .stats-grid {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 10px;
            margin-top: 20px;
            text-align: center;
        }

        .stat-item .label { font-size: 12px; color: var(--text-sub); margin-bottom: 4px; }
        .stat-item .value { font-size: 18px; font-weight: 600; color: var(--text-main); }

        /* --- åˆ—è¡¨æ ·å¼ (ç”¨äºæ€»è§ˆ) --- */
        .subject-list-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 0;
            border-bottom: 1px solid #f0f0f0;
        }
        .subject-list-item:last-child { border-bottom: none; }
        
        .sub-name { font-weight: 500; }
        .sub-score { font-weight: bold; color: var(--primary); }

        /* --- è¯¦æƒ…è¡¨æ ¼ (ä»¿æ™ºå­¦ç½‘é¢˜å‹åˆ†æ) --- */
        .detail-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 14px;
        }
        .detail-table th { text-align: left; color: var(--text-sub); font-weight: normal; padding: 8px 4px; border-bottom: 1px solid #f0f0f0; }
        .detail-table td { padding: 10px 4px; border-bottom: 1px solid #f0f0f0; }
        .score-bar-bg { width: 100%; height: 6px; background: #f0f0f0; border-radius: 3px; overflow: hidden; margin-top: 4px; }
        .score-bar-fill { height: 100%; background: var(--primary); width: 0; transition: width 0.5s; border-radius: 3px; }

        /* --- ç¼–è¾‘æ¨¡å¼ --- */
        .editable[contenteditable="true"] {
            background: rgba(68, 138, 255, 0.1);
            outline: 2px solid var(--primary);
            border-radius: 2px;
            min-width: 20px;
            display: inline-block;
            padding: 0 4px;
        }

        /* Toast æç¤º */
        #toast {
            position: fixed;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0,0,0,0.8);
            color: #fff;
            padding: 10px 20px;
            border-radius: 20px;
            font-size: 14px;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s;
            z-index: 200;
        }
        #toast.show { opacity: 1; }

    </style>
</head>
<body>

<header class="app-header">
    <div class="header-top" id="headerTitle">2025æœŸæœ«å­¦æƒ…æŠ¥å‘Š</div>
    <div class="nav-scroller">
        <div class="nav-item active" onclick="switchTab('total')">æ€»è§ˆ</div>
        <div class="nav-item" onclick="switchTab('yuwen')">è¯­æ–‡</div>
        <div class="nav-item" onclick="switchTab('shuxue')">æ•°å­¦</div>
        <div class="nav-item" onclick="switchTab('yingyu')">è‹±è¯­</div>
        <div class="nav-item" onclick="switchTab('wuli')">ç‰©ç†</div>
        <div class="nav-item" onclick="switchTab('huaxue')">åŒ–å­¦</div>
        <div class="nav-item" onclick="switchTab('shengwu')">ç”Ÿç‰©</div>
        <div class="nav-item" onclick="switchTab('zhengzhi')">æ”¿æ²»</div>
        <div class="nav-item" onclick="switchTab('lishi')">å†å²</div>
        <div class="nav-item" onclick="switchTab('dili')">åœ°ç†</div>
    </div>
</header>

<div id="toast"></div>

<div id="tab-total" class="tab-content active">
    <div class="card" style="background: linear-gradient(135deg, #448aff, #2979ff); color: white;">
        <div style="display: flex; justify-content: space-between; align-items: center;">
            <div>
                <div style="font-size: 20px; font-weight: bold;" class="editable">ææ˜</div>
                <div style="font-size: 13px; opacity: 0.9; margin-top: 5px;">è€ƒå·ï¼š<span class="editable">20230852</span></div>
            </div>
            <div style="text-align: right;">
                <div style="font-size: 13px; opacity: 0.9;">ç­çº§</div>
                <div style="font-size: 16px; font-weight: 600;" class="editable">é«˜äºŒ(3)ç­</div>
            </div>
        </div>
    </div>

    <div class="card">
        <div class="card-title">æˆç»©æ¦‚è§ˆ</div>
        <div class="score-dashboard">
            <div class="ring-container">
                <svg class="progress-ring" width="160" height="160">
                    <circle stroke="#eee" stroke-width="10" fill="transparent" r="70" cx="80" cy="80"/>
                    <circle class="progress-ring__circle" stroke="#448aff" stroke-width="10" fill="transparent" r="70" cx="80" cy="80" id="total-ring-circle"/>
                </svg>
                <div class="score-overlay">
                    <div class="big-score" id="grand-total-display">0</div>
                    <div class="total-label">æ€»åˆ†</div>
                </div>
            </div>
            
            <div class="stats-grid" style="width: 100%;">
                <div class="stat-item">
                    <div class="label">ç­çº§æ’å</div>
                    <div class="value editable">3</div>
                </div>
                <div class="stat-item">
                    <div class="label">å¹´çº§æ’å</div>
                    <div class="value editable">45</div>
                </div>
                <div class="stat-item">
                    <div class="label">è¶…è¿‡äººæ•°</div>
                    <div class="value editable">96%</div>
                </div>
            </div>
        </div>
    </div>

    <div class="card">
        <div class="card-title">å„ç§‘è¯¦æƒ…</div>
        <div id="summary-list">
            </div>
    </div>
</div>

<div id="subjects-container"></div>


<script>
    // === 1. æ•°æ®é…ç½® (è¿™æ˜¯æ ¸å¿ƒï¼Œæ‰€æœ‰åˆ†æ•°åœ¨è¿™é‡Œ) ===
    // ä½ å¯ä»¥åœ¨è¿™é‡Œä¿®æ”¹åˆå§‹åˆ†æ•°ï¼Œæˆ–è€…åœ¨é¡µé¢ä¸Šç”¨ä¸Šå¸æ¨¡å¼æ”¹
    const subjects = [
        { id: 'yuwen', name: 'è¯­æ–‡', score: 112, max: 150, classRank: 5, gradeRank: 52, avg: 105 },
        { id: 'shuxue', name: 'æ•°å­¦', score: 135, max: 150, classRank: 1, gradeRank: 12, avg: 98 },
        { id: 'yingyu', name: 'è‹±è¯­', score: 128, max: 150, classRank: 4, gradeRank: 40, avg: 110 },
        { id: 'wuli', name: 'ç‰©ç†', score: 88, max: 100, classRank: 8, gradeRank: 65, avg: 72 },
        { id: 'huaxue', name: 'åŒ–å­¦', score: 92, max: 100, classRank: 3, gradeRank: 28, avg: 78 },
        { id: 'shengwu', name: 'ç”Ÿç‰©', score: 85, max: 100, classRank: 6, gradeRank: 55, avg: 75 },
        { id: 'zhengzhi', name: 'æ”¿æ²»', score: 76, max: 100, classRank: 12, gradeRank: 120, avg: 70 },
        { id: 'lishi', name: 'å†å²', score: 82, max: 100, classRank: 9, gradeRank: 90, avg: 74 },
        { id: 'dili', name: 'åœ°ç†', score: 79, max: 100, classRank: 10, gradeRank: 100, avg: 71 }
    ];

    // === 2. åˆå§‹åŒ–æ¸²æŸ“é¡µé¢ ===
    const container = document.getElementById('subjects-container');
    const summaryList = document.getElementById('summary-list');

    subjects.forEach(sub => {
        // 1. ç”Ÿæˆå•ç§‘é¡µé¢ HTML
        const html = `
        <div id="tab-${sub.id}" class="tab-content">
            <div class="card">
                <div class="card-title">${sub.name}æˆç»©åˆ†æ</div>
                <div class="score-dashboard">
                    <div class="ring-container">
                        <svg class="progress-ring" width="160" height="160">
                            <circle stroke="#eee" stroke-width="10" fill="transparent" r="70" cx="80" cy="80"/>
                            <circle class="progress-ring__circle ring-${sub.id}" stroke="#448aff" stroke-width="10" fill="transparent" r="70" cx="80" cy="80"/>
                        </svg>
                        <div class="score-overlay">
                            <div class="big-score editable score-input" data-id="${sub.id}" data-max="${sub.max}">${sub.score}</div>
                            <div class="total-label">æ»¡åˆ† ${sub.max}</div>
                        </div>
                    </div>
                    <div class="stats-grid" style="width: 100%;">
                        <div class="stat-item">
                            <div class="label">ç­çº§æ’å</div>
                            <div class="value editable">${sub.classRank}</div>
                        </div>
                        <div class="stat-item">
                            <div class="label">å¹´çº§æ’å</div>
                            <div class="value editable">${sub.gradeRank}</div>
                        </div>
                        <div class="stat-item">
                            <div class="label">å­¦ç§‘å¹³å‡åˆ†</div>
                            <div class="value editable">${sub.avg}</div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="card">
                <div class="card-title">é¢˜å‹å¾—åˆ†è¯¦æƒ…</div>
                <table class="detail-table">
                    <tr>
                        <th width="30%">é¢˜å‹</th>
                        <th width="20%">å¾—åˆ†</th>
                        <th width="50%">å¾—åˆ†ç‡</th>
                    </tr>
                    <tr>
                        <td><span class="editable">é€‰æ‹©é¢˜</span></td>
                        <td><span class="editable">${Math.floor(sub.score * 0.4)}</span></td>
                        <td>
                            <div class="score-bar-bg">
                                <div class="score-bar-fill" style="width: 85%"></div>
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td><span class="editable">å¡«ç©ºé¢˜</span></td>
                        <td><span class="editable">${Math.floor(sub.score * 0.2)}</span></td>
                        <td>
                            <div class="score-bar-bg">
                                <div class="score-bar-fill" style="width: 70%"></div>
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td><span class="editable">è§£ç­”é¢˜</span></td>
                        <td><span class="editable">${Math.floor(sub.score * 0.4)}</span></td>
                        <td>
                            <div class="score-bar-bg">
                                <div class="score-bar-fill" style="width: 60%"></div>
                            </div>
                        </td>
                    </tr>
                </table>
            </div>

            <div class="card">
                <div class="card-title">æ•™å¸ˆè¯„è¯­</div>
                <div style="font-size:14px; color:#666; line-height:1.6;" class="editable">
                    ${sub.name}åŸºç¡€çŸ¥è¯†æŒæ¡æ‰å®ï¼Œå·é¢æ•´æ´ã€‚å»ºè®®åç»­åŠ å¼ºå¯¹éš¾é¢˜çš„æ”»å…‹ï¼Œæ³¨æ„å®¡é¢˜ç»†èŠ‚ã€‚
                </div>
            </div>
        </div>
        `;
        container.insertAdjacentHTML('beforeend', html);

        // 2. ç”Ÿæˆæ€»è§ˆé¡µé¢çš„åˆ—è¡¨é¡¹
        const summaryHtml = `
            <div class="subject-list-item">
                <div class="sub-name">${sub.name}</div>
                <div>
                    <span style="font-size:12px; color:#999; margin-right:5px;">ç­æ’ <span class="summary-rank-${sub.id}">${sub.classRank}</span></span>
                    <span class="sub-score summary-score-${sub.id}">${sub.score}</span>
                </div>
            </div>
        `;
        summaryList.insertAdjacentHTML('beforeend', summaryHtml);
    });

    // === 3. é€»è¾‘æ§åˆ¶ ===

    // åˆ‡æ¢ Tab
    function switchTab(tabId) {
        // éšè—æ‰€æœ‰
        document.querySelectorAll('.tab-content').forEach(el => el.classList.remove('active'));
        document.querySelectorAll('.nav-item').forEach(el => el.classList.remove('active'));
        
        // æ˜¾ç¤ºå½“å‰
        document.getElementById('tab-' + tabId).classList.add('active');
        // æ‰¾åˆ°å¯¹åº”çš„ nav-item é«˜äº® (è¿™é‡Œç®€å•å¤„ç†ï¼Œé€šè¿‡éå†æ–‡æœ¬å†…å®¹æˆ–ç´¢å¼•)
        const navItems = document.querySelectorAll('.nav-item');
        // ç®€å•çš„æ˜ å°„é€»è¾‘
        const map = {
            'total': 0, 'yuwen': 1, 'shuxue': 2, 'yingyu': 3, 'wuli': 4, 
            'huaxue': 5, 'shengwu': 6, 'zhengzhi': 7, 'lishi': 8, 'dili': 9
        };
        if(navItems[map[tabId]]) navItems[map[tabId]].classList.add('active');
        
        // å¦‚æœæ˜¯æ€»è§ˆé¡µæˆ–å•ç§‘é¡µï¼Œé‡æ–°è§¦å‘ä¸€ä¸‹åŠ¨ç”»æ¸²æŸ“
        if(tabId === 'total') {
            updateTotal();
        } else {
            // æ‰¾åˆ°å•ç§‘çš„ input æ›´æ–°åœ†ç¯
            const input = document.querySelector(`#tab-${tabId} .score-input`);
            updateRing(input);
        }
    }

    // æ›´æ–°åœ†ç¯è¿›åº¦
    function updateRing(target) {
        if(!target) return;
        const score = parseFloat(target.innerText) || 0;
        const max = parseFloat(target.getAttribute('data-max')) || 100;
        const id = target.getAttribute('data-id');
        
        // æ‰¾å¯¹åº”çš„ circle
        const circle = document.querySelector(`.ring-${id}`);
        if(circle) {
            setCircleProgress(circle, score, max);
        }
    }

    function setCircleProgress(circle, score, max) {
        const radius = circle.r.baseVal.value;
        const circumference = 2 * Math.PI * radius;
        circle.style.strokeDasharray = `${circumference} ${circumference}`;
        
        let percent = score / max;
        if(percent > 1) percent = 1;
        if(percent < 0) percent = 0;
        
        const offset = circumference - (percent * circumference);
        circle.style.strokeDashoffset = offset;
        
        // é¢œè‰²åŠ¨æ€å˜åŒ–ï¼šä¸åŠæ ¼çº¢è‰²ï¼Œä¼˜ç§€ç»¿è‰²
        if(percent < 0.6) circle.style.stroke = "#ff5252";
        else if(percent >= 0.85) circle.style.stroke = "#4caf50";
        else circle.style.stroke = "#448aff";
    }

    // æ›´æ–°æ€»åˆ†
    function updateTotal() {
        let totalScore = 0;
        let totalMax = 0;

        // éå†æ‰€æœ‰å•ç§‘åˆ†æ•°
        document.querySelectorAll('.score-input').forEach(el => {
            const val = parseFloat(el.innerText);
            const max = parseFloat(el.getAttribute('data-max'));
            const id = el.getAttribute('data-id');
            
            if(!isNaN(val)) {
                totalScore += val;
                // åŒæ—¶æ›´æ–°æ€»è§ˆåˆ—è¡¨é‡Œçš„å°æ•°å­—
                const summaryScoreEl = document.querySelector(`.summary-score-${id}`);
                if(summaryScoreEl) summaryScoreEl.innerText = val;
            }
            if(!isNaN(max)) totalMax += max;
        });

        // æ›´æ–°å¤§åœ†ç¯æ–‡å­—
        const totalDisplay = document.getElementById('grand-total-display');
        totalDisplay.innerText = totalScore;

        // æ›´æ–°å¤§åœ†ç¯è¿›åº¦
        const totalCircle = document.getElementById('total-ring-circle');
        setCircleProgress(totalCircle, totalScore, totalMax);
    }


    // === 4. ä¸Šå¸æ¨¡å¼ (ç¼–è¾‘åŠŸèƒ½) ===
    let clickCount = 0;
    let clickTimer = null;
    let isEditMode = false;
    const titleBtn = document.getElementById('headerTitle');

    titleBtn.addEventListener('click', () => {
        clickCount++;
        clearTimeout(clickTimer);
        clickTimer = setTimeout(() => { clickCount = 0; }, 800);
        if(clickCount === 3) {
            toggleEditMode();
            clickCount = 0;
        }
    });

    function toggleEditMode() {
        isEditMode = !isEditMode;
        const editables = document.querySelectorAll('.editable');
        const toast = document.getElementById('toast');
        
        if(isEditMode) {
            editables.forEach(el => el.setAttribute('contenteditable', 'true'));
            toast.innerText = "ğŸ›  ç¼–è¾‘æ¨¡å¼å·²å¼€å¯ï¼šç‚¹å‡»æ•°å­—å³å¯ä¿®æ”¹";
            toast.classList.add('show');
            setTimeout(() => toast.classList.remove('show'), 3000);
        } else {
            editables.forEach(el => el.removeAttribute('contenteditable'));
            toast.innerText = "âœ… å·²ä¿å­˜";
            toast.classList.add('show');
            setTimeout(() => toast.classList.remove('show'), 2000);
        }
    }

    // ç›‘å¬è¾“å…¥ï¼Œå®æ—¶è®¡ç®—
    document.addEventListener('input', (e) => {
        if(e.target.classList.contains('score-input')) {
            updateRing(e.target);
            updateTotal();
        }
    });

    // åˆå§‹åŒ–è¿è¡Œä¸€æ¬¡
    updateTotal();
    subjects.forEach(sub => {
         const input = document.querySelector(`.score-input[data-id="${sub.id}"]`);
         updateRing(input);
    });

</script>
</body>
</html>
