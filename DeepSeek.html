<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>DeepSeek</title> <!-- 页面标题为 DeepSeek -->
  <!-- FONT: DeepSeek 官方字体 -->
  <style>
    @font-face {
      font-family: 'DeepSeekFont';
      src: url('fontDS.ttf') format('truetype');
      font-weight: normal;
      font-style: normal;
    }
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'DeepSeekFont', sans-serif; /* 应用 DeepSeek 官方字体 5 */
    }

    /* ===== 主题切换相关 ===== */
    :root {
      --color-bg-main-light: #FFFFFF;       /* 主背景：白色  */
      --color-bg-sidebar-light: #F5F5F5;    /* 侧边栏背景：浅灰 (#F5F5F5)  */
      --color-bg-chat-light: #FFFFFF;       /* 聊天区背景：白色  */
      --color-bg-input-light: #EEEEEE;      /* 输入区背景：更浅灰 (#EEEEEE)  */
      --color-bubble-ai-light: #E5E5E5;     /* AI 气泡背景：灰 (#E5E5E5)  */
      --color-bubble-user-light: #D3D3D3;   /* 用户气泡背景：灰 (#D3D3D3)  */
      --color-text-light: #1A1A1A;          /* 浅色主题文字：深灰 (#1A1A1A)  */
      --color-icon-light: #1A1A1A;          /* 图标颜色：深灰  */
      --color-border-light: #DDDDDD;        /* 边框：浅灰 (#DDDDDD)  */

      --color-bg-main-dark: #18191A;        /* 主背景：深色 (#18191A)  */
      --color-bg-sidebar-dark: #202225;     /* 侧边栏深色 (#202225) 16 */
      --color-bg-chat-dark: #18191A;        /* 聊天区深背景 (#18191A)  */
      --color-bg-input-dark: #202225;       /* 输入区深背景 (#202225) 18 */
      --color-bubble-ai-dark: #282B30;      /* AI 气泡深灰 (#282B30) 19 */
      --color-bubble-user-dark: #5865F2;    /* 用户气泡深色 (#5865F2) 20 */
      --color-text-dark: #E3E5E8;           /* 深色文字：浅灰 (#E3E5E8) 21 */
      --color-icon-dark: #E3E5E8;           /* 深色图标：浅灰 22 */
      --color-border-dark: #2F3136;         /* 边框：深灰 (#2F3136) 23 */
    }

    /* 默认浅色主题 */
    body.light {
      background-color: var(--color-bg-main-light);
      color: var(--color-text-light);
    }
    body.light .sidebar {
      background-color: var(--color-bg-sidebar-light);
      border-top: 1px solid var(--color-border-light);
    }
    body.light .chat-window {
      background-color: var(--color-bg-chat-light);
    }
    body.light .chat-input {
      background-color: var(--color-bg-input-light);
      border-top: 1px solid var(--color-border-light);
    }
    body.light .message.ai .bubble {
      background-color: var(--color-bubble-ai-light);
      color: var(--color-text-light);
    }
    body.light .message.user .bubble {
      background-color: var(--color-bubble-user-light);
      color: var(--color-text-light);
    }
    body.light .icon-btn svg path,
    body.light .toggle-btn svg path {
      stroke: var(--color-icon-light);
      fill: var(--color-icon-light);
    }
    body.light .new-chat-btn {
      background-color: var(--color-bubble-user-light);
      color: var(--color-text-light);
      border: 1px solid var(--color-border-light);
    }

    /* 深色主题（与之前完全一致） */
    body.dark {
      background-color: var(--color-bg-main-dark);
      color: var(--color-text-dark);
    }
    body.dark .sidebar {
      background-color: var(--color-bg-sidebar-dark);
    }
    body.dark .chat-window {
      background-color: var(--color-bg-chat-dark);
    }
    body.dark .chat-input {
      background-color: var(--color-bg-input-dark);
      border-top: 1px solid var(--color-border-dark);
    }
    body.dark .message.ai .bubble {
      background-color: var(--color-bubble-ai-dark);
      color: var(--color-text-dark);
    }
    body.dark .message.user .bubble {
      background-color: var(--color-bubble-user-dark);
      color: var(--color-text-dark);
    }
    body.dark .icon-btn svg path,
    body.dark .toggle-btn svg path {
      stroke: var(--color-icon-dark);
      fill: var(--color-icon-dark);
    }
    body.dark .new-chat-btn {
      background-color: var(--color-bubble-user-dark);
      color: var(--color-text-dark);
      border: none;
    }

    /* ===== 布局与 UI 样式 ===== */
    html, body {
      height: 100%;
      width: 100%;
      overflow: hidden;
      transition: background-color 0.3s, color 0.3s;
    }
    .container {
      display: flex;
      height: 100vh;
      width: 100%;
    }
    /* 侧边栏 */
    .sidebar {
      width: 280px;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      transition: background-color 0.3s, transform 0.3s;
    }
    .sidebar-header {
      display: flex;
      align-items: center;
      padding: 20px;
    }
    .sidebar-header img {
      width: 32px;
      height: 32px;
      margin-right: 10px;
    }
    .sidebar-header span {
      font-size: 1.2rem;
      font-weight: bold;
    }
    .new-chat-btn {
      display: flex;
      align-items: center;
      margin: 10px 20px;
      padding: 10px 14px;
      border-radius: 8px;
      font-size: 0.95rem;
      cursor: pointer;
      transition: background 0.2s, color 0.2s;
    }
    .new-chat-btn:hover {
      opacity: 0.85;
    }
    .new-chat-btn svg {
      width: 18px;
      height: 18px;
      margin-right: 8px;
      stroke: currentColor;
      fill: currentColor;
    }
    /* 侧边栏聊天列表 */
    .chat-list {
      flex: 1;
      overflow-y: auto;
      padding: 20px;
      font-size: 0.9rem;
      line-height: 1.5;
      text-align: center;
    }
    .chat-list p {
      color: #7a7c80; /* 占位文字为灰色 24 */
    }
    .sidebar-footer {
      display: flex;
      align-items: center;
      padding: 20px;
      border-top: 1px solid;
    }
    .profile-pic {
      width: 36px;
      height: 36px;
      border-radius: 50%;
      background: #CCCCCC; /* 占位浅灰，可替换为实际头像 */
      margin-right: 12px;
    }
    .profile-name {
      font-size: 1rem;
    }
    /* 主区域 */
    .main {
      flex: 1;
      display: flex;
      flex-direction: column;
      transition: background-color 0.3s;
    }
    .chat-window {
      flex: 1;
      padding: 20px 24px;
      overflow-y: auto;
      scrollbar-width: none;
      transition: background-color 0.3s;
    }
    .chat-window::-webkit-scrollbar {
      display: none;
    }
    /* 消息气泡 */
    .message {
      display: flex;
      margin-bottom: 16px;
      opacity: 0;
      transform: translateY(20px);
      animation: slide-in 0.25s forwards; /* 滑入动画 25 */
    }
    @keyframes slide-in {
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
    .message.ai {
      justify-content: flex-start;
    }
    .message.user {
      justify-content: flex-end;
    }
    .message .avatar {
      width: 32px;
      height: 32px;
      border-radius: 50%;
      margin-right: 8px;
      flex-shrink: 0;
    }
    .message .bubble {
      max-width: 65%;
      padding: 10px 14px;
      font-size: 1rem;
      line-height: 1.5;
      word-break: break-word;
      border-radius: 12px;
    }
    .message.ai .bubble {
      border-radius: 12px 12px 12px 0px;
    }
    .message.user .bubble {
      border-radius: 12px 12px 0px 12px;
    }
    /* 输入区 */
    .chat-input {
      display: flex;
      align-items: center;
      padding: 10px 20px;
      border-top: 1px solid;
      transition: background-color 0.3s, border-color 0.3s;
    }
    .chat-input input {
      flex: 1;
      height: 40px;
      padding: 0 14px;
      border: none;
      border-radius: 8px;
      font-size: 1rem;
      outline: none;
      transition: background-color 0.3s, color 0.3s;
    }
    .icon-btn {
      width: 40px;
      height: 40px;
      margin-left: 12px;
      border: none;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: background 0.2s;
      flex-shrink: 0;
    }
    .icon-btn:hover {
      opacity: 0.85;
    }
    .icon-btn svg {
      width: 20px;
      height: 20px;
      stroke: currentColor;
      fill: currentColor;
    }
    /* 主题切换按钮 */
    .toggle-btn {
      position: absolute;
      top: 10px;
      right: 10px;
      width: 36px;
      height: 36px;
      border: none;
      background: transparent;
      cursor: pointer;
      transition: opacity 0.2s;
      z-index: 11;
    }
    .toggle-btn:hover {
      opacity: 0.7;
    }
    .toggle-btn svg {
      width: 24px;
      height: 24px;
      stroke: currentColor;
      fill: currentColor;
    }
    /* 加载动画样式 */
    .loading-container {
      display: flex;
      justify-content: center;
      align-items: center;
      margin-bottom: 16px;
    }
    .loading-gif {
      width: 48px;
      height: 48px;
    }
    /* 响应式折叠侧边栏 */
    @media (max-width: 600px) {
      .sidebar {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        transform: translateY(-100%);
        z-index: 10;
      }
      .sidebar.visible {
        transform: translateY(0);
      }
      .main {
        margin-top: 60px;
      }
      .toggle-btn {
        display: flex;
        align-items: center;
        justify-content: center;
      }
    }
  </style>

  <!-- 网站图标 -->
  <link rel="icon" href="deepseek.png" type="image/png" />
</head>
<body>
  <div class="container">
    <!-- 主题切换按钮 -->
    <button class="toggle-btn" id="toggleThemeBtn" title="切换主题">
      <!-- 太阳/月亮 图标 SVG，与官方一致 26 -->
      <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
        <path d="M12 3.25a.75.75 0 0 1 .75.75V6a.75.75 0 0 1-1.5 0V4a.75.75 0 0 1 .75-.75ZM18.364 5.636a.75.75 0 0 1 1.06 1.06l-1.06 1.06a.75.75 0 0 1-1.06-1.06l1.06-1.06ZM20.75 12a.75.75 0 0 1 .75.75H22a.75.75 0 0 1 0-1.5h-1.5a.75.75 0 0 1 .25.75ZM18.364 18.364a.75.75 0 0 1-1.06 1.06l-1.06-1.06a.75.75 0 0 1 1.06-1.06l1.06 1.06ZM12 17.25a.75.75 0 0 1 .75.75V20a.75.75 0 0 1-1.5 0v-2a.75.75 0 0 1 .75-.75ZM5.636 18.364a.75.75 0 0 1-1.06-1.06l1.06-1.06a.75.75 0 1 1 1.06 1.06l-1.06 1.06ZM3.25 12a.75.75 0 0 1-.75.75H0.75a.75.75 0 0 1 0-1.5H2.5a.75.75 0 0 1 .75.75ZM5.636 5.636a.75.75 0 0 1 0 1.06L4.576 7.756a.75.75 0 1 1-1.06-1.06l1.06-1.06a.75.75 0 0 1 1.06 0ZM12 8a4 4 0 1 1 0 8 4 4 0 0 1 0-8Z" fill="currentColor"/>
      </svg>
    </button>

    <!-- 侧边栏 -->
    <aside class="sidebar" id="sidebar">
      <div>
        <!-- Logo 区域 -->
        <div class="sidebar-header">
          <img src="deepseek.png" alt="DeepSeek Logo" />
          <span>deepseek</span>
        </div>
        <!-- New Chat 按钮 -->
        <button class="new-chat-btn" id="newChatBtn">
          <!-- “+” 图标 SVG -->
          <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
            <path d="M12 5v14M5 12h14" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
          </svg>
          <span>New Chat</span>
        </button>
        <!-- 聊天历史列表 -->
        <div class="chat-list" id="chatList">
          <p>无聊天历史</p>
        </div>
      </div>
      <!-- 侧边栏底部：用户信息 -->
      <div class="sidebar-footer">
        <div class="profile-pic"></div>
        <div class="profile-name">我的账户</div>
      </div>
    </aside>

    <!-- 主区域 -->
    <div class="main">
      <!-- 聊天窗口 -->
      <div class="chat-window" id="chatWindow">
        <!-- 消息与加载动画将由 JS 动态插入 -->
      </div>
      <!-- 输入区域 -->
      <div class="chat-input">
        <input type="text" id="userInput" placeholder="给DeepSeek发送消息" autocomplete="off" />
        <!-- 深度思考 按钮 -->
        <button class="icon-btn" id="deepThinkBtn" title="深度思考">
          <!-- Brain 图标 SVG，与官方一致 27 -->
          <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
            <path d="M12 2a4 4 0 0 0-4 4v3a4 4 0 1 0 8 0V6a4 4 0 0 0-4-4Zm0 2a2 2 0 0 1 2 2v3a2 2 0 1 1-4 0V6a2 2 0 0 1 2-2Zm-6 9a1 1 0 0 0 0 2h12a1 1 0 1 0 0-2H6Zm-1 4a1 1 0 0 0-1 1 5 5 0 0 0 5 5h2a5 5 0 0 0 5-5 1 1 0 1 0-2 0 3 3 0 0 1-3 3H10a3 3 0 0 1-3-3 1 1 0 0 0-1-1Z" fill="currentColor"/>
          </svg>
        </button>
        <!-- 搜索 按钮 -->
        <button class="icon-btn" id="searchBtn" title="搜索">
          <!-- Magnifier 图标 SVG，与官方一致 28 -->
          <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
            <circle cx="11" cy="11" r="7" stroke="currentColor" stroke-width="2" fill="none"/>
            <line x1="16.65" y1="16.65" x2="21" y2="21" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
          </svg>
        </button>
      </div>
    </div>
  </div>

  <!-- 自定义回复映射表 -->
  <script src="responses.js"></script>
  <!-- 前端脚本：主题切换、消息插入、加载动画、延迟与逐字符显示 -->
  <script>
    document.addEventListener('DOMContentLoaded', function () {
      const bodyEl = document.body;
      const sidebar = document.getElementById('sidebar');
      const toggleThemeBtn = document.getElementById('toggleThemeBtn');
      const newChatBtn = document.getElementById('newChatBtn');
      const chatList = document.getElementById('chatList');
      const chatWindow = document.getElementById('chatWindow');
      const userInput = document.getElementById('userInput');
      const deepThinkBtn = document.getElementById('deepThinkBtn');
      const searchBtn = document.getElementById('searchBtn');

      // ===== 主题初始化：根据系统 prefers-color-scheme 设置默认 =====
      function initTheme() {
        if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
          bodyEl.classList.add('dark');
        } else {
          bodyEl.classList.add('light');
        }
      }
      initTheme(); /* 尊重用户系统偏好 29 */

      // 切换主题（Light ↔ Dark）
      toggleThemeBtn.addEventListener('click', () => {
        if (bodyEl.classList.contains('light')) {
          bodyEl.classList.remove('light');
          bodyEl.classList.add('dark');
        } else {
          bodyEl.classList.remove('dark');
          bodyEl.classList.add('light');
        }
      });

      // ===== 移动端响应式：折叠/展开侧边栏 =====
      function updateLayout() {
        if (window.innerWidth <= 600) {
          sidebar.classList.remove('visible');
        } else {
          sidebar.classList.remove('visible');
        }
      }
      updateLayout();
      window.addEventListener('resize', updateLayout);

      // ===== New Chat：清空聊天记录 =====
      newChatBtn.addEventListener('click', () => {
        chatWindow.innerHTML = '';
        chatList.innerHTML = '<p>无聊天历史</p>';
      });

      // ===== 插入单条消息到聊天窗口 =====
      function addMessage(text, sender) {
        const messageEl = document.createElement('div');
        messageEl.classList.add('message', sender);

        // 如果是 AI 消息，则先插入头像
        if (sender === 'ai') {
          const avatarEl = document.createElement('img');
          avatarEl.src = 'deepseek.png';
          avatarEl.alt = 'DeepSeek Avatar';
          avatarEl.classList.add('avatar');
          messageEl.appendChild(avatarEl); /* AI 消息前显示头像 30 */
        }

        const bubbleEl = document.createElement('div');
        bubbleEl.classList.add('bubble');
        messageEl.appendChild(bubbleEl);
        chatWindow.appendChild(messageEl);

        // 滑入动画
        setTimeout(() => {
          messageEl.style.opacity = '1';
          messageEl.style.transform = 'translateY(0)';
        }, 10);

        // 滚动到底部
        chatWindow.scrollTop = chatWindow.scrollHeight;

        return bubbleEl; // 返回气泡元素，用于逐字符填充
      }

      // ===== 从 responses.js 获取 AI 回复 =====
      function getResponse(input) {
        const key = input.trim();
        if (window.responses && window.responses[key] !== undefined) {
          return window.responses[key];
        } else {
          return '服务器繁忙，请稍后再试';
        }
      }

      // ===== 逐字符滚动显示内容，速率约 11–12 字符/秒 (90ms/字符) =====
      function typeText(element, text, speed = 90) {
        let index = 0;
        element.textContent = '';
        return new Promise(resolve => {
          const intervalId = setInterval(() => {
            if (index < text.length) {
              element.textContent += text.charAt(index);
              index++;
            } else {
              clearInterval(intervalId);
              resolve();
            }
          }, speed);
        });
      }

      // ===== 发送消息：用户 → AI =====
      async function sendMessage() {
        const text = userInput.value.trim();
        if (!text) return;

        // 首次消息时清空侧边栏占位文本
        if (chatList.innerHTML.trim() !== '') {
          chatList.innerHTML = '';
        }

        // 1. 添加用户消息（右侧灰色气泡）
        addMessage(text, 'user');

        // 2. 清空输入框
        userInput.value = '';

        // 3. 插入加载动画（jz.gif），并在 5–7 秒后移除
        const loadingContainer = document.createElement('div');
        loadingContainer.classList.add('loading-container');
        const loadingGif = document.createElement('img');
        loadingGif.src = 'jz.gif'; /* 加载动画 31 */
        loadingGif.alt = 'Loading';
        loadingGif.classList.add('loading-gif');
        loadingContainer.appendChild(loadingGif);
        chatWindow.appendChild(loadingContainer);
        chatWindow.scrollTop = chatWindow.scrollHeight;

        // 4. 模拟 DeepSeek 真实思考：随机延迟 5000–7000ms
        const delay = 5000 + Math.random() * 2000; /* 5–7 秒 32 */
        await new Promise(res => setTimeout(res, delay));

        // 5. 移除加载动画
        loadingContainer.remove();

        // 6. 获取 AI 回复内容
        const reply = getResponse(text);

        // 7. 插入 AI 气泡并获取气泡元素
        const bubbleEl = addMessage('', 'ai');

        // 8. 逐字符呈现 AI 回复
        await typeText(bubbleEl, reply, 90 /* 每秒约 11 字符 33 */);
      }

      // 点击“深度思考”或“搜索”按钮，都触发 sendMessage
      deepThinkBtn.addEventListener('click', sendMessage);
      searchBtn.addEventListener('click', sendMessage);

      // 按 Enter 键发送
      userInput.addEventListener('keypress', (e) => {
        if (e.key === 'Enter') {
          sendMessage();
        }
      });
    });
  </script>
</body>
</html>